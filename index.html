<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8559690324489971"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net; connect-src 'self' https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://ep1.adtrafficquality.google; frame-src 'self' https://googleads.g.doubleclick.net; base-uri 'self'; form-action 'self'">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iNCIgeT0iNiIgd2lkdGg9IjE4IiBoZWlnaHQ9IjI0IiByeD0iMiIgZmlsbD0iIzFlNDBhZiIvPgo8cGF0aCBkPSJNMTYgNiBMMjAgMTAgTDE2IDEwIFoiIGZpbGw9IiMwZjE3MmEiIG9wYWNpdHk9IjAuMyIvPgo8cmVjdCB4PSI3IiB5PSIxMCIgd2lkdGg9IjEwIiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOSIvPgo8cmVjdCB4PSI3IiB5PSIxMi41IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjciIHk9IjE1IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjciIHk9IjE3LjUiIHdpZHRoPSI3IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgo8cmVjdCB4PSI3IiB5PSIyMCIgd2lkdGg9IjkiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CjxyZWN0IHg9IjciIHk9IjIyLjUiIHdpZHRoPSI1IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNSIvPgo8dGV4dCB4PSIyOCIgeT0iMTQiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iOCIgZm9udC13ZWlnaHQ9IjcwMCIgZmlsbD0iIzFlNDBhZiI+VFM8L3RleHQ+Cjwvc3ZnPgo=">
  <title>Character Counter</title>
  <!-- AdSense Auto Ads -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8559690324489971" crossorigin="anonymous"></script>
  <style>
    :root {
      color-scheme: light dark;
      --bg1: #f3f6fb; --bg2: #ffffff;
      --text: #0f172a; --muted: #475569;
      --card: #ffffffcc; --border: #c7cedb66;
      --accent: #2563eb; --accent-2: #9333ea;
      --ad-bg: #f8fafcaa;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg1: #0b1220; --bg2: #0a0f1a;
        --text: #e5e7eb; --muted: #9aa4b2;
        --card: #121a2dcc; --border: #5c6b8266;
        --accent: #60a5fa; --accent-2: #c084fc;
        --ad-bg: #0f172aaa;
      }
      .brand-text { 
        background: linear-gradient(135deg, #60a5fa, #22d3ee);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; height: 100%; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, sans-serif;
      color: var(--text);
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 50%, var(--bg1) 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      display: flex; flex-direction: column;
      min-height: 100vh;
      /* Mobile optimizations */
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header {
      position: sticky; top: 0; z-index: 10;
      background: var(--card);
      backdrop-filter: saturate(140%) blur(6px);
      border-bottom: 1px solid var(--border);
    }
    .nav { max-width: 1200px; margin: 0 auto; padding: 14px 20px; display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 800; letter-spacing: .2px; }
    .brand-logo { height: 32px; width: auto; }
    .brand-text { 
      background: linear-gradient(135deg, #1e40af, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 1.1em;
      font-weight: 700;
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    select, button { 
      padding: 12px 16px; 
      border-radius: 12px; 
      border: 1px solid var(--border); 
      background: var(--card); 
      color: var(--text); 
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }
    button.primary { 
      background: linear-gradient(135deg, var(--accent), var(--accent-2)); 
      color: #fff; 
      border-color: transparent;
      box-shadow: 0 6px 20px rgba(37,99,235,.3);
    }
    button:hover { 
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(0,0,0,.15);
    }
    button.primary:hover {
      box-shadow: 0 8px 25px rgba(37,99,235,.4);
    }
    main { flex: 1; }
    .container { max-width: 1200px; margin: 24px auto; padding: 0 20px; }

    .ad-slot { background: var(--ad-bg); border: 1px dashed var(--border); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--muted); overflow: hidden; }
    .ad-slot img { display: block; width: 100%; height: 100%; object-fit: cover; }
    #adTop { height: 100px; margin: 10px 0 20px; }
    #adInline { height: 90px; margin: 14px 0; }
    #adFooter { height: 90px; margin: 18px 0 0; }

    .hero { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: stretch; margin-bottom: 20px; }
    @media (max-width: 960px) { .hero { grid-template-columns: 1fr; gap: 16px; } }
    
    .hero-feature {
      padding: 12px;
      border: 1px dashed var(--border);
      border-radius: 12px;
      text-align: center;
    }
    .hero-feature-title {
      font-weight: 700;
      margin-bottom: 4px;
      font-size: 0.95em;
    }
    .hero-feature-desc {
      font-size: 0.85em;
      line-height: 1.3;
      color: var(--muted);
    }
    .hero-card { 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 20px; 
      padding: 24px; 
      box-shadow: 0 20px 40px rgba(0,0,0,.08), 0 8px 16px rgba(0,0,0,.04);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 140px;
    }
    .hero-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
    }
    .title { font-size: 1.1em; font-weight: 800; margin: 0 0 8px; }
    .subtitle { color: var(--muted); margin: 0; line-height: 1.4; font-size: 0.95em; }

    .panel { 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 20px; 
      padding: 24px; 
      box-shadow: 0 20px 40px rgba(0,0,0,.08), 0 8px 16px rgba(0,0,0,.04);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    .panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
    }
    .row { display: flex; gap: 8px; align-items: center; margin-bottom: 8px; }
    textarea { 
      width: 100%; 
      min-height: 240px; 
      resize: vertical; 
      border: 2px solid var(--border); 
      background: var(--card); 
      color: var(--text); 
      border-radius: 16px; 
      padding: 16px; 
      font: inherit; 
      line-height: 1.6;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(37,99,235,.1), 0 8px 20px rgba(0,0,0,.1);
    }
    .under-actions { display: flex; justify-content: flex-start; margin-top: 12px; gap: 12px; }
    .clear-btn {
      background: linear-gradient(135deg, var(--muted), #64748b);
      color: white;
      border: none;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(71,85,105,.3);
    }
    .clear-btn:hover {
      background: linear-gradient(135deg, #64748b, #475569);
      box-shadow: 0 6px 20px rgba(71,85,105,.4);
    }

    .stats { margin-top: 16px; display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .card { 
      padding: 18px; 
      border: 1px solid var(--border); 
      border-radius: 16px; 
      background: var(--card);
      box-shadow: 0 8px 20px rgba(0,0,0,.06);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(0,0,0,.1);
    }
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    .label { color: var(--muted); font-size: .9em; font-weight: 500; }
    .value { font-weight: 800; font-size: 1.4em; margin-top: 4px; color: var(--accent); }

    footer { color: var(--muted); text-align: center; padding: 24px 12px; }

    #adModal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.5); z-index: 9999; }
    .ad-wrap { width: min(720px, 92vw); background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.3); overflow: hidden; }
    .ad-head { padding: 14px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .ad-body { padding: 22px; height: 320px; display: flex; align-items: center; justify-content: center; text-align: center; }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
      .nav { padding: 12px 16px; flex-direction: column; gap: 16px; }
      .brand { justify-content: center; }
      .brand-logo { height: 28px; }
      .controls { justify-content: center; }
      
      .container { padding: 16px; }
      .hero { gap: 16px; }
      .hero-card { padding: 20px; }
      .title { font-size: 1.2em; }
      .subtitle { font-size: 0.9em; }
      
      .hero-feature { padding: 16px; }
      .hero-feature-title { font-size: 0.9em; }
      .hero-feature-desc { font-size: 0.8em; }
      
      .panel { padding: 20px; }
      .row { flex-direction: column; gap: 12px; }
      .primary { padding: 14px 20px; font-size: 1em; }
      
      textarea { 
        min-height: 200px; 
        font-size: 16px; /* Prevents zoom on iOS */
        padding: 16px;
      }
      
      .under-actions { flex-direction: column; gap: 12px; }
      .clear-btn { padding: 12px 20px; }
      
      .stats { 
        grid-template-columns: 1fr; 
        gap: 16px; 
        margin-top: 20px; 
      }
      .card { padding: 16px; }
      .value { font-size: 1.2em; }
      
      .ad-wrap { width: 95vw; margin: 0 2.5vw; }
      .ad-body { height: 280px; padding: 16px; }
      
      footer { padding: 20px 16px; font-size: 0.9em; }
    }
    
    @media (max-width: 480px) {
      .nav { padding: 10px 12px; }
      .container { padding: 12px; }
      .hero-card { padding: 16px; }
      .panel { padding: 16px; }
      .title { font-size: 1.1em; }
      .subtitle { font-size: 0.85em; }
      
      textarea { 
        min-height: 180px; 
        padding: 14px;
        font-size: 16px;
      }
      
      .stats { gap: 12px; }
      .card { padding: 14px; }
      .value { font-size: 1.1em; }
      .label { font-size: 0.85em; }
      
      .ad-wrap { width: 98vw; margin: 0 1vw; }
      .ad-body { height: 250px; padding: 12px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand">
        <img class="brand-logo" id="logoHome" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTgwIDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8IS0tIERvY3VtZW50IGljb24gLS0+CjxyZWN0IHg9IjIiIHk9IjMiIHdpZHRoPSIxOCIgaGVpZ2h0PSIyNCIgcng9IjIiIGZpbGw9IiMxZTQwYWYiLz4KPHBhdGggZD0iTTE2IDMgTDIwIDcgTDE2IDcgWiIgZmlsbD0iIzBmMTcyYSIgb3BhY2l0eT0iMC4zIi8+CjxyZWN0IHg9IjUiIHk9IjciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxLjIiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjkiLz4KPHJlY3QgeD0iNSIgeT0iOS41IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjUiIHk9IjEyIiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjUiIHk9IjE0LjUiIHdpZHRoPSI3IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgo8cmVjdCB4PSI1IiB5PSIxNyIgd2lkdGg9IjkiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CjxyZWN0IHg9IjUiIHk9IjE5LjUiIHdpZHRoPSI1IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNSIvPgoKPCEtLSBUeXBlU3RhdHMgdGV4dCAtLT4KPHRleHQgeD0iMjYiIHk9IjEyIiBmb250LWZhbWlseT0ic3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmb250LXdlaWdodD0iODAwIiBmaWxsPSIjMWU0MGFmIj5UeXBlPC90ZXh0Pgo8dGV4dCB4PSIyNiIgeT0iMjIiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtd2VpZ2h0PSI4MDAiIGZpbGw9InVybCgjc3RhdHNHcmFkaWVudCkiPlN0YXRzPC90ZXh0PgoKPGRlZnM+CjxsaW5lYXJHcmFkaWVudCBpZD0ic3RhdHNHcmFkaWVudCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMCUiPgo8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMWU0MGFmO3N0b3Atb3BhY2l0eToxIiAvPgo8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwNmI2ZDQ7c3RvcC1vcGFjaXR5OjEiIC8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==" alt="TypeStats Logo" style="cursor: pointer;">
        <div id="brandText" class="brand-text">AI-powered Multilingual Character Counter</div>
      </div>
      <div class="controls">
        <label for="lang" class="sr-only" style="position:absolute;left:-9999px">Language</label>
        <select id="lang" aria-label="Language"></select>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <div id="adTop" class="ad-slot">
        <!-- Top Banner - TypeStats -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8559690324489971"
             data-ad-slot="3634322089"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <div class="hero">
        <div class="hero-card">
          <h1 class="title" id="title">Character Counter</h1>
          <p class="subtitle" id="subtitle">Paste text to analyze multilingual counts accurately.</p>
        </div>
        <div class="hero-card">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
            <div class="hero-feature">
              <div class="hero-feature-title" id="hi1">Accurate</div>
              <div class="hero-feature-desc" id="hi1s">Counts letters, words, digits, punctuation by language.</div>
            </div>
            <div class="hero-feature">
              <div class="hero-feature-title" id="hi2">Smart rules</div>
              <div class="hero-feature-desc" id="hi2s">Korean-dominant rule, otherwise unified rule.</div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="row">
          <button id="pasteBtnTop" class="primary" type="button">Paste text</button>
        </div>

        <textarea id="textInput" placeholder="Type or paste your text…"></textarea>
        <div class="under-actions">
          <button id="clearBtn" class="clear-btn" type="button">Clear</button>
        </div>

        <div id="adInline" class="ad-slot">
          <!-- Inline Banner - TypeStats -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-8559690324489971"
               data-ad-slot="5824537000"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>

        <div id="result" style="margin-top: 12px;"></div>

        <div id="adFooter" class="ad-slot">
          <!-- Footer Banner - TypeStats -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-8559690324489971"
               data-ad-slot="3077301779"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
    </div>
  </main>

  <footer>
    © 2025 Type Stats. All rights reserved.
  </footer>

  <div id="adModal">
    <div class="ad-wrap">
      <div class="ad-head">
        <div style="font-weight:700">Notice</div>
        <button id="adClose" type="button" style="padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:transparent;cursor:pointer">Close</button>
      </div>
      <div class="ad-body" id="adMessage">
        <!-- typestats-pop-up -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8559690324489971"
             data-ad-slot="8708902408"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>
  </div>

  <script>
    // Basic regexes
    const RX = {
      punct: /\p{P}/gu,
      latin: /[A-Za-z]/g,
      ew: /(?<![A-Za-z0-9])[A-Za-z0-9'-]*[A-Za-z][A-Za-z0-9'-]*(?![A-Za-z0-9])/g,
      han: /\p{Script=Han}/gu,
      hangul: /\p{Script=Hangul}/gu,
      hira: /\p{Script=Hiragana}/gu,
      kata: /\p{Script=Katakana}/gu,
      thai: /\p{Script=Thai}/gu,
      arab: /\p{Script=Arabic}/gu,
      deva: /\p{Script=Devanagari}/gu,
      cyrl: /\p{Script=Cyrillic}/gu,
      greek:/\p{Script=Greek}/gu,
      hebr: /\p{Script=Hebrew}/gu
    };

    // Normalize pasted text (top and tail cleanup)
    function normalizePasted(text) {
      return text
        .replace(/\r\n?/g, '\n')
        .replace(/^\s*\n+/, '')
        .replace(/\n{3,}/g, '\n\n')
        .replace(/\s+$/g, '');
    }

    // i18n (UI + labels + script names)
    const i18n = {
      ui: {
        en:{title:'Multilingual Character Counter',subtitle:'Analyze scripts with language-specific intelligence—accurate counts for Korean, Chinese, English, and more.',paste:'Paste text',clear:'Clear',placeholder:'Type or paste your text…',hi1:'AI Precision',hi1s:'Language-aware counts for characters, words, digits, and punctuation—tailored for each script.',hi2:'Smart Rules',hi2s:'Applies Korean-focused or multilingual rules dynamically. Perfect for bilingual scripts.',brand:'AI-powered Multilingual Character Counter'},
        ko:{title:'다국어 글자수세기',subtitle:'AI가 계산하는 정확한 글자수, 콘텐츠 품질의 시작입니다.',paste:'텍스트 붙여넣기',clear:'지우기',placeholder:'텍스트를 입력하거나 붙여넣으세요…',hi1:'AI 정밀도',hi1s:'언어별 글자·단어·숫자·문장부호 집계.',hi2:'스마트 규칙',hi2s:'한국어 최다 시 특수 규칙, 그 외 통일 규칙.',brand:'언어별 규칙에 맞춘 AI 기반 글자수 분석기'},
        'zh-CN':{title:'多语言字符计数器',subtitle:'用语言特定智能分析脚本——为韩语、中文、英语等提供准确计数。',paste:'粘贴文本',clear:'清空',placeholder:'输入或粘贴文本…',hi1:'AI精准',hi1s:'针对每种脚本量身定制的字符、单词、数字和标点符号的语言感知计数。',hi2:'智能规则',hi2s:'动态应用韩语重点或多语言规则。完美适用于双语脚本。',brand:'AI驱动的多语言字符计数器'},
        'zh-TW':{title:'多語文字元計數器',subtitle:'用語言特定智慧分析腳本——為韓語、中文、英語等提供精準計數。',paste:'貼上文字',clear:'清除',placeholder:'輸入或貼上文字…',hi1:'AI精準',hi1s:'針對每種腳本量身定制的字元、單字、數字和標點符號的語言感知計數。',hi2:'智慧規則',hi2s:'動態應用韓語重點或多語言規則。完美適用於雙語腳本。',brand:'AI驅動的多語文字元計數器'},
        ja:{title:'多言語文字数カウンター',subtitle:'言語固有の知能でスクリプトを分析——韓国語、中国語、英語など正確なカウント。',paste:'テキストを貼り付け',clear:'クリア',placeholder:'テキストを入力/貼り付け…',hi1:'AI精密',hi1s:'各スクリプトに合わせた文字、単語、数字、句読点の言語認識カウント。',hi2:'スマート規則',hi2s:'韓国語重点または多言語規則を動的に適用。バイリンガルスクリプトに最適。',brand:'AI駆動多言語文字数カウンター'},
        th:{title:'ตัวนับอักขระหลายภาษา',subtitle:'วิเคราะห์สคริปต์ด้วยความฉลาดเฉพาะภาษา—นับที่แม่นยำสำหรับเกาหลี จีน อังกฤษ และอื่นๆ',paste:'วางข้อความ',clear:'ล้าง',placeholder:'พิมพ์หรือวางข้อความ…',hi1:'AI ความแม่นยำ',hi1s:'นับอักขระ คำ ตัวเลข เครื่องหมายวรรคตอนที่รู้จักภาษา—ปรับให้เหมาะกับแต่ละสคริปต์',hi2:'กฎอัจฉริยะ',hi2s:'ใช้กฎเน้นเกาหลีหรือหลายภาษาอย่างไดนามิก เหมาะสำหรับสคริปต์สองภาษา',brand:'ตัวนับอักขระหลายภาษาที่ขับเคลื่อนด้วย AI'},
        vi:{title:'Bộ đếm ký tự đa ngôn ngữ',subtitle:'Phân tích kịch bản với trí tuệ đặc thù ngôn ngữ—đếm chính xác cho Hàn, Trung, Anh và hơn thế.',paste:'Dán văn bản',clear:'Xóa',placeholder:'Nhập hoặc dán văn bản…',hi1:'AI Chính xác',hi1s:'Đếm ký tự, từ, số, dấu câu nhận biết ngôn ngữ—tùy chỉnh cho từng kịch bản.',hi2:'Quy tắc thông minh',hi2s:'Áp dụng động quy tắc tập trung Hàn Quốc hoặc đa ngôn ngữ. Hoàn hảo cho kịch bản song ngữ.',brand:'Bộ đếm ký tự đa ngôn ngữ được AI hỗ trợ'},
        ru:{title:'Многоязычный счётчик символов',subtitle:'Анализ скриптов с языковой специфической интеллектуальностью—точный подсчёт для корейского, китайского, английского и других.',paste:'Вставить текст',clear:'Очистить',placeholder:'Введите или вставьте текст…',hi1:'AI Точность',hi1s:'Языково-осведомлённый подсчёт символов, слов, цифр и пунктуации—настроенный для каждого скрипта.',hi2:'Умные правила',hi2s:'Динамически применяет корейско-ориентированные или многоязычные правила. Идеально для двуязычных скриптов.',brand:'Многоязычный счётчик символов на базе ИИ'},
        ar:{title:'عداد الأحرف متعدد اللغات',subtitle:'تحليل النصوص بذكاء خاص باللغة—عد دقيق للكورية والصينية والإنجليزية والمزيد.',paste:'لصق النص',clear:'مسح',placeholder:'اكتب أو الصق النص…',hi1:'دقة الذكاء الاصطناعي',hi1s:'عد الأحرف والكلمات والأرقام وعلامات الترقيم الواعي باللغة—مخصص لكل نص.',hi2:'قواعد ذكية',hi2s:'يطبق قواعد مركزة على الكورية أو متعددة اللغات ديناميكياً. مثالي للنصوص ثنائية اللغة.',brand:'عداد الأحرف متعدد اللغات مدعوم بالذكاء الاصطناعي'},
        fr:{title:'Compteur de caractères multilingue',subtitle:'Analysez les scripts avec une intelligence spécifique à la langue—comptes précis pour le coréen, chinois, anglais et plus.',paste:'Coller le texte',clear:'Effacer',placeholder:'Saisissez ou collez du texte…',hi1:'Précision IA',hi1s:'Comptes conscients de la langue pour caractères, mots, chiffres et ponctuation—adaptés à chaque script.',hi2:'Règles intelligentes',hi2s:'Applique dynamiquement des règles centrées sur le coréen ou multilingues. Parfait pour les scripts bilingues.',brand:'Compteur de caractères multilingue alimenté par IA'},
        de:{title:'Mehrsprachiger Zeichenzähler',subtitle:'Analysieren Sie Skripte mit sprachspezifischer Intelligenz—genaue Zählungen für Koreanisch, Chinesisch, Englisch und mehr.',paste:'Text einfügen',clear:'Löschen',placeholder:'Text eingeben oder einfügen…',hi1:'KI-Präzision',hi1s:'Sprachbewusste Zählungen für Zeichen, Wörter, Ziffern und Interpunktion—angepasst an jedes Skript.',hi2:'Smarte Regeln',hi2s:'Wendet dynamisch koreanisch-fokussierte oder mehrsprachige Regeln an. Perfekt für zweisprachige Skripte.',brand:'KI-gestützter mehrsprachiger Zeichenzähler'},
        es:{title:'Contador de caracteres multilingüe',subtitle:'Analiza scripts con inteligencia específica del idioma—conteos precisos para coreano, chino, inglés y más.',paste:'Pegar texto',clear:'Borrar',placeholder:'Escribe o pega texto…',hi1:'Precisión IA',hi1s:'Conteos conscientes del idioma para caracteres, palabras, dígitos y puntuación—adaptados a cada script.',hi2:'Reglas inteligentes',hi2s:'Aplica dinámicamente reglas centradas en coreano o multilingües. Perfecto para scripts bilingües.',brand:'Contador de caracteres multilingüe impulsado por IA'},
        pt:{title:'Contador de caracteres multilíngue',subtitle:'Analise scripts com inteligência específica da linguagem—contagens precisas para coreano, chinês, inglês e mais.',paste:'Colar texto',clear:'Limpar',placeholder:'Digite ou cole o texto…',hi1:'Precisão IA',hi1s:'Contagens conscientes da linguagem para caracteres, palavras, dígitos e pontuação—adaptadas a cada script.',hi2:'Regras inteligentes',hi2s:'Aplica dinamicamente regras focadas no coreano ou multilíngues. Perfeito para scripts bilíngues.',brand:'Contador de caracteres multilíngue alimentado por IA'}
      },
      labels: {
        en:{scriptChars:n=>`${n} characters`,enLetters:'English letters',enWords:'English words',digits:'Digits',punct:'Punctuation',total:'Total (no spaces)',noPunct:'no punctuation'},
        ko:{scriptChars:n=>`${n} 글자수`,enLetters:'영어 글자수',enWords:'영어 단어 수',digits:'숫자',punct:'문장부호',total:'전체 글자수 (공백 제외)',noPunct:'문장부호 제외'},
        'zh-CN':{scriptChars:n=>`${n} 字数`,enLetters:'英文字母数',enWords:'英文单词数',digits:'数字',punct:'标点符号',total:'总字数（去空白）',noPunct:'不含标点'},
        'zh-TW':{scriptChars:n=>`${n} 字数`,enLetters:'英文字母數',enWords:'英文單字數',digits:'數字',punct:'標點符號',total:'總字数（去空白）',noPunct:'不含標點'},
        ja:{scriptChars:n=>`${n} 文字数`,enLetters:'英語の文字数',enWords:'英語の単語数',digits:'数字',punct:'句読点',total:'総文字数（空白除く）',noPunct:'句読点除く'},
        th:{scriptChars:n=>`${n} ตัวอักษร`,enLetters:'ตัวอักษรอังกฤษ',enWords:'คำภาษาอังกฤษ',digits:'ตัวเลข',punct:'เครื่องหมายวรรคตอน',total:'รวม (ไม่รวมช่องว่าง)',noPunct:'ไม่รวมเครื่องหมาย'},
        vi:{scriptChars:n=>`${n} ký tự`,enLetters:'Chữ cái tiếng Anh',enWords:'Từ tiếng Anh',digits:'Chữ số',punct:'Dấu câu',total:'Tổng (không tính khoảng trắng)',noPunct:'không tính dấu câu'},
        ru:{scriptChars:n=>`${n} символов`,enLetters:'Английские буквы',enWords:'Английские слова',digits:'Цифры',punct:'Знаки препинания',total:'Всего (без пробелов)',noPunct:'без пунктуации'},
        ar:{scriptChars:n=>`${n} حرف`,enLetters:'حروف إنجليزية',enWords:'كلمات إنجليزية',digits:'أرقام',punct:'علامات ترقيم',total:'الإجمالي (بدون مسافات)',noPunct:'بدون ترقيم'},
        fr:{scriptChars:n=>`${n} caractères`,enLetters:'Lettres anglaises',enWords:'Mots anglais',digits:'Chiffres',punct:'Ponctuation',total:'Total (sans espaces)',noPunct:'sans ponctuation'},
        de:{scriptChars:n=>`${n} Zeichen`,enLetters:'Englische Buchstaben',enWords:'Englische Wörter',digits:'Ziffern',punct:'Zeichensetzung',total:'Gesamt (ohne Leerzeichen)',noPunct:'ohne Interpunktion'},
        es:{scriptChars:n=>`${n} caracteres`,enLetters:'Letras en inglés',enWords:'Palabras en inglés',digits:'Dígitos',punct:'Puntuación',total:'Total (sin espacios)',noPunct:'sin puntuación'},
        pt:{scriptChars:n=>`${n} caracteres`,enLetters:'Letras em inglês',enWords:'Palavras em inglês',digits:'Dígitos',punct:'Pontuação',total:'Total (sem espaços)',noPunct:'sem pontuação'}
      },
      scripts: {
        en:{Korean:'Korean',Chinese:'Chinese',Japanese:'Japanese',Thai:'Thai',Arabic:'Arabic',Devanagari:'Hindi',Cyrillic:'Cyrillic',Greek:'Greek',Hebrew:'Hebrew'},
        ko:{Korean:'한국어',Chinese:'중국어',Japanese:'일본어',Thai:'태국어',Arabic:'아랍어',Devanagari:'힌디어',Cyrillic:'키릴 문자',Greek:'그리스어',Hebrew:'히브리어'},
        'zh-CN':{Korean:'韩语',Chinese:'中文',Japanese:'日语',Thai:'泰语',Arabic:'阿拉伯语',Devanagari:'印地语',Cyrillic:'西里尔文',Greek:'希腊语',Hebrew:'希伯来语'},
        'zh-TW':{Korean:'韓語',Chinese:'中文',Japanese:'日語',Thai:'泰語',Arabic:'阿拉伯語',Devanagari:'印地語',Cyrillic:'西里爾文',Greek:'希臘語',Hebrew:'希伯來語'},
        ja:{Korean:'韓国語',Chinese:'中国語',Japanese:'日本語',Thai:'タイ語',Arabic:'アラビア語',Devanagari:'ヒンディー語',Cyrillic:'キリル文字',Greek:'ギリシャ語',Hebrew:'ヘブライ語'},
        th:{Korean:'เกาหลี',Chinese:'จีน',Japanese:'ญี่ปุ่น',Thai:'ไทย',Arabic:'อาหรับ',Devanagari:'ฮินดี',Cyrillic:'ซีริลลิก',Greek:'กรีก',Hebrew:'ฮีบรู'},
        vi:{Korean:'Hàn',Chinese:'Trung',Japanese:'Nhật',Thai:'Thái',Arabic:'Ả Rập',Devanagari:'Hindi',Cyrillic:'Chữ Kirin',Greek:'Hy Lạp',Hebrew:'Do Thái'},
        ru:{Korean:'Корейский',Chinese:'Китайский',Japanese:'Японский',Thai:'Тайский',Arabic:'Арабский',Devanagari:'Хинди',Cyrillic:'Кириллица',Greek:'Греческий',Hebrew:'Иврит'},
        ar:{Korean:'الكورية',Chinese:'الصينية',Japanese:'اليابانية',Thai:'التايلاندية',Arabic:'العربية',Devanagari:'الهندية',Cyrillic:'السيريلية',Greek:'اليونانية',Hebrew:'العبرية'},
        fr:{Korean:'Coréen',Chinese:'Chinois',Japanese:'Japonais',Thai:'Thaï',Arabic:'Arabe',Devanagari:'Hindi',Cyrillic:'Cyrillique',Greek:'Grec',Hebrew:'Hébreu'},
        de:{Korean:'Koreanisch',Chinese:'Chinesisch',Japanese:'Japanisch',Thai:'Thailändisch',Arabic:'Arabisch',Devanagari:'Hindi',Cyrillic:'Kyrillisch',Greek:'Griechisch',Hebrew:'Hebräisch'},
        es:{Korean:'Coreano',Chinese:'Chino',Japanese:'Japonés',Thai:'Tailandés',Arabic:'Árabe',Devanagari:'Hindi',Cyrillic:'Cirílico',Greek:'Griego',Hebrew:'Hebreo'},
        pt:{Korean:'Coreano',Chinese:'Chinês',Japanese:'Japonês',Thai:'Tailandês',Arabic:'Árabe',Devanagari:'Hindi',Cyrillic:'Cirílico',Greek:'Grego',Hebrew:'Hebraico'}
      }
    };

    const langOrder = ['en','ko','zh-CN','zh-TW','ja','th','vi','ru','ar','fr','de','es','pt'];

    function localScriptName(key, uiLang) {
      const m = i18n.scripts[uiLang] || i18n.scripts.en;
      return m[key] || key;
    }

    function setUILanguage(lang) {
      const u = i18n.ui[lang] || i18n.ui.en;
      document.documentElement.lang = lang;
      document.getElementById('brandText').textContent = u.brand;
      document.getElementById('title').textContent = u.title;
      document.getElementById('subtitle').textContent = u.subtitle;
      document.getElementById('textInput').placeholder = u.placeholder;
      document.getElementById('hi1').textContent = u.hi1;
      document.getElementById('hi1s').textContent = u.hi1s;
      document.getElementById('hi2').textContent = u.hi2;
      document.getElementById('hi2s').textContent = u.hi2s;
      document.getElementById('pasteBtnTop').textContent = u.paste;
      document.getElementById('clearBtn').textContent = u.clear;
      onInput();
    }

    function countNonEmptyLines(text) {
      const normalized = text.replace(/\r\n?/g, '\n');
      if (!normalized) return 0;
      return normalized.split('\n').filter(l => l.trim().length > 0).length;
    }

    function analyze(text, uiLang) {
      const noSpaces = text.replace(/\s+/g, '');
      const englishLetters = (noSpaces.match(RX.latin) || []).length;
      const englishWords = (text.match(RX.ew) || []).length;
      const digits = (noSpaces.match(/[0-9]/g) || []).length;
      const punct = (noSpaces.match(RX.punct) || []).length;

      const counts = {
        Korean: (noSpaces.match(RX.hangul) || []).length,
        Chinese: (noSpaces.match(RX.han) || []).length,
        Hiragana: (noSpaces.match(RX.hira) || []).length,
        Katakana: (noSpaces.match(RX.kata) || []).length,
        Thai: (noSpaces.match(RX.thai) || []).length,
        Arabic: (noSpaces.match(RX.arab) || []).length,
        Devanagari: (noSpaces.match(RX.deva) || []).length,
        Cyrillic: (noSpaces.match(RX.cyrl) || []).length,
        Greek: (noSpaces.match(RX.greek) || []).length,
        Hebrew: (noSpaces.match(RX.hebr) || []).length
      };
      counts.Japanese = (counts.Hiragana || 0) + (counts.Katakana || 0);
      delete counts.Hiragana; delete counts.Katakana;

      let primary = { key: null, count: 0 };
      for (const [k, v] of Object.entries(counts)) if (v > primary.count) primary = { key: k, count: v };

      const englishDisplay = (primary.key === 'Korean') ? englishLetters : englishWords;

      const sumScripts = Object.values(counts).reduce((a,b)=>a+b,0);
      const englishForTotal = (primary.key === 'Korean') ? englishLetters : englishWords;
      const allLanguagesUnits = sumScripts + englishForTotal;
      const total = (primary.key === 'Korean') ? noSpaces.length : (allLanguagesUnits + digits);

      return { uiLang, counts, primary, englishDisplay, englishWords, digits, punct, total };
    }

    function render(stats) {
      const L = i18n.labels[stats.uiLang] || i18n.labels.en;
      const englishLabel = (stats.primary.key === 'Korean') ? L.enLetters : L.enWords;

      const scriptCards = Object.entries(stats.counts)
        .filter(([, v]) => v > 0)
        .map(([k, v]) => {
          const nameLoc = localScriptName(k, stats.uiLang);
          return `<div class="card"><div class="label">${L.scriptChars(nameLoc)}</div><div class="value">${v.toLocaleString()}</div></div>`;
        }).join('');

      let totalLabel = L.total;
      let totalSubtitle = '';
      if (stats.primary.key !== 'Korean') {
        const comp = [];
        for (const [k, v] of Object.entries(stats.counts)) if (v > 0) comp.push(localScriptName(k, stats.uiLang));
        if (stats.englishWords > 0) comp.push(englishLabel);
        comp.push(L.digits);
        totalSubtitle = `${comp.join(' + ')}, ${L.noPunct}`;
      }

      document.getElementById('result').innerHTML = `
        <div class="stats">
          ${scriptCards}
          <div class="card"><div class="label">${englishLabel}</div><div class="value">${stats.englishDisplay.toLocaleString()}</div></div>
          <div class="card"><div class="label">${L.digits}</div><div class="value">${stats.digits.toLocaleString()}</div></div>
          <div class="card"><div class="label">${L.punct}</div><div class="value">${stats.punct.toLocaleString()}</div></div>
          <div class="card">
            <div class="label">${totalLabel}</div>
            <div class="value">${stats.total.toLocaleString()}</div>
            ${totalSubtitle ? `<div class="subtitle" style="font-size:0.8em;color:var(--muted);margin-top:4px;">${totalSubtitle}</div>` : ''}
          </div>
        </div>
      `;
    }

    async function pasteText() {
      const el = document.getElementById('textInput');
      try {
        let clip = await navigator.clipboard.readText();
        clip = normalizePasted(clip);
        const start = el.selectionStart ?? el.value.length;
        const end   = el.selectionEnd ?? el.value.length;
        el.value = el.value.slice(0, start) + clip + el.value.slice(end);
        const pos = start + clip.length;
        el.setSelectionRange?.(pos, pos);
      } catch {
        const fallback = prompt('Paste is not allowed by the browser.\nPlease paste your content here:');
        if (fallback !== null) {
          const cleaned = normalizePasted(fallback);
          el.value += (el.value ? '\n' : '') + cleaned;
        }
      }
      el.scrollTop = 0;
      showAdAfterPaste();
      el.focus();
    }

    function clearText() {
      const el = document.getElementById('textInput');
      el.value = '';
      document.getElementById('result').innerHTML = '';
      el.focus();
    }

    let inputTimer;
    function onInput() {
      clearTimeout(inputTimer);
      inputTimer = setTimeout(() => {
        const uiLang = document.getElementById('lang').value;
        const text = document.getElementById('textInput').value;
        render(analyze(text, uiLang));
      }, 60);
    }

    // Always show modal after paste (every time)
    function showAdAfterPaste() {
      const modal = document.getElementById('adModal');
      modal.style.display = 'flex';
      document.getElementById('adClose').onclick = () => {
        modal.style.display = 'none';
        onInput();
      };
    }

    // Browser language detection
    function detectBrowserLanguage() {
      const browserLang = navigator.language || navigator.userLanguage || 'en';
      const langCode = browserLang.split('-')[0]; // Get primary language code
      
      // Map browser languages to our supported languages
      const langMap = {
        'ko': 'ko',
        'zh': 'zh-CN',
        'ja': 'ja',
        'th': 'th',
        'vi': 'vi',
        'ru': 'ru',
        'ar': 'ar',
        'fr': 'fr',
        'de': 'de',
        'es': 'es',
        'pt': 'pt'
      };
      
      return langMap[langCode] || 'en'; // Default to English if not supported
    }

    window.addEventListener('DOMContentLoaded', () => {
      // Fill localized thank-you message in modal (optional simple EN/KR)
      const msg = {
        en: "Thanks for using our text counter. Close this message to see your results.",
        ko: "이용해 주셔서 감사합니다. 닫기를 누르면 결과를 확인할 수 있어요."
      };
      
      const sel = document.getElementById('lang');
      sel.innerHTML = ['en','ko','zh-CN','zh-TW','ja','th','vi','ru','ar','fr','de','es','pt'].map(code => {
        const label = ({en:'English',ko:'한국어','zh-CN':'中文(简体)','zh-TW':'中文(繁體)',ja:'日本語',th:'ภาษาไทย',vi:'Tiếng Việt',ru:'Русский',ar:'العربية',fr:'Français',de:'Deutsch',es:'Español',pt:'Português'})[code];
        return `<option value="${code}">${label}</option>`;
      }).join('');
      
      // Set default language based on browser
      const defaultLang = detectBrowserLanguage();
      sel.value = defaultLang;
      
      // Initialize UI with detected language
      setUILanguage(defaultLang);
      document.getElementById('adMessage').textContent =
        defaultLang === 'ko' ? msg.ko : msg.en;
      
      sel.addEventListener('change', () => {
        setUILanguage(sel.value);
        document.getElementById('adMessage').textContent =
          sel.value === 'ko' ? msg.ko : msg.en;
      });

      // Top paste button
      document.getElementById('pasteBtnTop').addEventListener('click', pasteText);
      // Clear
      document.getElementById('clearBtn').addEventListener('click', clearText);

      // Textarea typing
      const ta = document.getElementById('textInput');
      ta.addEventListener('input', onInput);
      // Keyboard paste handling (Cmd/Ctrl+V)
      ta.addEventListener('paste', (e) => {
        e.preventDefault();
        const raw = (e.clipboardData || window.clipboardData)?.getData('text') || '';
        const cleaned = normalizePasted(raw);
        const start = ta.selectionStart ?? ta.value.length;
        const end   = ta.selectionEnd ?? ta.value.length;
        ta.value = ta.value.slice(0, start) + cleaned + ta.value.slice(end);
        const pos = start + cleaned.length;
        ta.setSelectionRange?.(pos, pos);
        ta.scrollTop = 0;
        showAdAfterPaste();
        ta.focus();
      }, { capture: true });

      // Language is already set by detectBrowserLanguage() above
      
      // Logo home link
      document.getElementById('logoHome').addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
      
      // Mobile touch optimizations
      
      // Prevent zoom on double tap for mobile
      let lastTouchEnd = 0;
      ta.addEventListener('touchend', (e) => {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          e.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      // Improve touch scrolling
      ta.style.webkitOverflowScrolling = 'touch';
      
      // Add touch feedback for buttons
      const buttons = document.querySelectorAll('button');
      buttons.forEach(btn => {
        btn.addEventListener('touchstart', () => {
          btn.style.transform = 'scale(0.98)';
        });
        btn.addEventListener('touchend', () => {
          btn.style.transform = 'scale(1)';
        });
      });
    });

    // Light "view source" deterrents (bypassable)
    document.addEventListener('contextmenu', (e) => e.preventDefault());
    document.addEventListener('keydown', (e) => {
      const k = e.key.toLowerCase();
      const ctrl = e.ctrlKey || e.metaKey;
      if (
        k === 'f12' ||
        (ctrl && k === 'u') ||
        (ctrl && e.shiftKey && ['i','j','c'].includes(k))
      ) {
        e.preventDefault();
      }
    });

    // Optional: limit features to your domain (keep modal)
    (function lockToDomain() {
      const allowed = ['typestats', 'localhost', '127.0.0.1', 'vercel.app'];
      const host = location.hostname || '';
      if (!allowed.some(a => host.includes(a))) {
        // Keep the app, but you could disable specific features if needed
      }
    })();
  </script>
<script defer src="/vercel/insights/script.js"></script>  
</body>
</html>