<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8559690324489971"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://www.googletagmanager.com; connect-src 'self' https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://ep1.adtrafficquality.google https://www.google-analytics.com https://analytics.google.com; frame-src 'self' https://googleads.g.doubleclick.net; base-uri 'self'; form-action 'self'">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iNCIgeT0iNiIgd2lkdGg9IjE4IiBoZWlnaHQ9IjI0IiByeD0iMiIgZmlsbD0iIzFlNDBhZiIvPgo8cGF0aCBkPSJNMTYgNiBMMjAgMTAgTDE2IDEwIFoiIGZpbGw9IiMwZjE3MmEiIG9wYWNpdHk9IjAuMyIvPgo8cmVjdCB4PSI3IiB5PSIxMCIgd2lkdGg9IjEwIiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOSIvPgo8cmVjdCB4PSI3IiB5PSIxMi41IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjciIHk9IjE1IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjciIHk9IjE3LjUiIHdpZHRoPSI3IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgo8cmVjdCB4PSI3IiB5PSIyMCIgd2lkdGg9IjkiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CjxyZWN0IHg9IjciIHk9IjIyLjUiIHdpZHRoPSI1IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNSIvPgo8dGV4dCB4PSIyOCIgeT0iMTQiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iOCIgZm9udC13ZWlnaHQ9IjcwMCIgZmlsbD0iIzFlNDBhZiI+VFM8L3RleHQ+Cjwvc3ZnPgo=">
  <title>AI-Powered Multilingual Character Counter | TypeStats</title>
  <meta name="description" content="Accurate multilingual character counter with AI-powered analysis. Count characters, words, digits, and punctuation for Korean, Chinese, English, Japanese, and more languages with smart rules.">
  <meta name="keywords" content="character counter, multilingual character count, Chinese character count, voice over script analyzer, text count, Korean count, Japanese count, online count, ai text count, gpt text count, free text count, online text count, script count, 글자수 세기, 글자수 계산기, 한글 글자수, 중문 글자수, 영어 글자수, 일본어 글자수 세기, 여러언어 글자수, 지피티 글자수 세기, 무료 글자수, 온라인 글자수세기, 字数统计器, 中文字数统计, 多语言文本分析, 字数统计, 在线字数, 统计字数, 韩语统计, 日语统计, 泰语统计, 韩语计算, 日语计算, 在线韩语统计, 免费字数统计, 免费统计字数, 免费统计">
  <meta name="author" content="TypeStats">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta name="naverbot" content="index, follow">
  <meta name="baiduspider" content="index, follow">
  <meta name="yandexbot" content="index, follow">
  <meta name="naver-site-verification" content="3a70df1e83beedaba68dd3596a3befa1d704cb12" />
  <meta name="baidu-site-verification" content="codeva-xS0zsvo6fP" />
  <link rel="canonical" href="https://typestats.com">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://typestats.com">
  <meta property="og:title" content="AI-Powered Multilingual Character Counter | TypeStats">
  <meta property="og:description" content="Accurate multilingual character counter with AI-powered analysis. Count characters, words, digits, and punctuation for Korean, Chinese, English, Japanese, and more languages.">
  <meta property="og:image" content="https://typestats.com/og-image.png">
  <meta property="og:site_name" content="TypeStats">
  <meta property="og:locale" content="en_US">
  <meta property="og:locale:alternate" content="ko_KR">
  <meta property="og:locale:alternate" content="zh_CN">
  <meta property="og:locale:alternate" content="ja_JP">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://typestats.com">
  <meta property="twitter:title" content="AI-Powered Multilingual Character Counter | TypeStats">
  <meta property="twitter:description" content="Accurate multilingual character counter with AI-powered analysis. Count characters, words, digits, and punctuation for Korean, Chinese, English, Japanese, and more languages.">
  <meta property="twitter:image" content="https://typestats.com/og-image.png">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WQTGQPQ2S5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-WQTGQPQ2S5', {
      custom_map: {
        'custom_parameter_1': 'language_detected',
        'custom_parameter_2': 'character_count',
        'custom_parameter_3': 'text_length'
      }
    });
  </script>
  
  <!-- AdSense Auto Ads -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8559690324489971" crossorigin="anonymous"></script>
  <style>
    :root {
      color-scheme: light dark;
      --bg1: #f3f6fb; --bg2: #ffffff;
      --text: #0f172a; --muted: #475569;
      --card: #ffffffcc; --border: #c7cedb66;
      --accent: #2563eb; --accent-2: #9333ea;
      --ad-bg: #f8fafcaa;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg1: #0b1220; --bg2: #0a0f1a;
        --text: #e5e7eb; --muted: #9aa4b2;
        --card: #121a2dcc; --border: #5c6b8266;
        --accent: #60a5fa; --accent-2: #c084fc;
        --ad-bg: #0f172aaa;
      }
      .brand-text { 
        background: linear-gradient(135deg, #60a5fa, #22d3ee);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; height: 100%; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, sans-serif;
      color: var(--text);
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 50%, var(--bg1) 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      display: flex; flex-direction: column;
      min-height: 100vh;
      /* Mobile optimizations */
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header {
      position: sticky; top: 0; z-index: 10;
      background: var(--card);
      backdrop-filter: saturate(140%) blur(6px);
      border-bottom: 1px solid var(--border);
    }
    .nav { max-width: 1200px; margin: 0 auto; padding: 14px 20px; display: flex; align-items: center; justify-content: space-between; gap: 12px; position: relative; }
    .brand { display: flex; align-items: center; gap: 0px; font-weight: 800; letter-spacing: .2px; }
    .brand-logo { height: 32px; width: auto; margin-right: 0px; }
    .brand-text { 
      background: linear-gradient(135deg, #1e40af, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 0.8em;
      font-weight: 700;
      margin-left: 0px;
      white-space: nowrap;
      display: none;
    }
    .controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .nav-center { 
      position: absolute; 
      left: 50%; 
      transform: translateX(-50%); 
      background: linear-gradient(135deg, #1e40af, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 0.8em;
      font-weight: 700;
      pointer-events: none;
      white-space: nowrap;
    }
    select, button { 
      padding: 12px 16px; 
      border-radius: 12px; 
      border: 1px solid var(--border); 
      background: var(--card); 
      color: var(--text); 
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }
    button.primary { 
      background: linear-gradient(135deg, var(--accent), var(--accent-2)); 
      color: #fff; 
      border-color: transparent;
      box-shadow: 0 6px 20px rgba(37,99,235,.3);
    }
    button:hover { 
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(0,0,0,.15);
    }
    button.primary:hover {
      box-shadow: 0 8px 25px rgba(37,99,235,.4);
    }
    main { flex: 1; }
    .container { max-width: 1200px; margin: 24px auto; padding: 0 20px; }

    .ad-slot { background: var(--ad-bg); border: 1px dashed var(--border); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--muted); overflow: hidden; }
    .ad-slot img { display: block; width: 100%; height: 100%; object-fit: cover; }
    #adTop { height: 100px; margin: 10px 0 20px; }
    #adInline { height: 90px; margin: 14px 0; }
    #adFooter { height: 90px; margin: 18px 0 0; }

    .hero { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: stretch; margin-bottom: 20px; }
    @media (max-width: 960px) { .hero { grid-template-columns: 1fr; gap: 16px; } }
    
    .hero-feature {
      padding: 12px;
      border: 1px dashed var(--border);
      border-radius: 12px;
      text-align: center;
    }
    .hero-feature-title {
      font-weight: 700;
      margin-bottom: 4px;
      font-size: 1em;
    }
    .hero-feature-desc {
      font-size: 0.9em;
      line-height: 1.3;
      color: var(--muted);
    }
    .hero-card { 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 20px; 
      padding: 24px; 
      box-shadow: 0 20px 40px rgba(0,0,0,.08), 0 8px 16px rgba(0,0,0,.04);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 140px;
    }
    .hero-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
    }
    .title { font-size: 1em; font-weight: 800; margin: 0 0 8px; }
    .subtitle { color: var(--muted); margin: 0; line-height: 1.4; font-size: 0.95em; }

    .panel { 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 20px; 
      padding: 24px; 
      box-shadow: 0 20px 40px rgba(0,0,0,.08), 0 8px 16px rgba(0,0,0,.04);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    .panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
    }
    .row { display: flex; gap: 8px; align-items: center; margin-bottom: 8px; flex-wrap: wrap; }
    textarea { 
      width: 100%; 
      min-height: 240px; 
      resize: vertical; 
      border: 2px solid var(--border); 
      background: var(--card); 
      color: var(--text); 
      border-radius: 16px; 
      padding: 16px; 
      font: inherit; 
      line-height: 1.6;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(37,99,235,.1), 0 8px 20px rgba(0,0,0,.1);
    }
    .under-actions { display: flex; justify-content: flex-start; margin-top: 12px; gap: 12px; }
    .clear-btn {
      background: linear-gradient(135deg, var(--muted), #64748b);
      color: white;
      border: none;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(71,85,105,.3);
    }
    .clear-btn:hover {
      background: linear-gradient(135deg, #64748b, #475569);
      box-shadow: 0 6px 20px rgba(71,85,105,.4);
    }
    
    .rules-btn {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border: none;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(16,185,129,.3);
      display: block !important;
      visibility: visible !important;
    }
    
    .rules-btn:hover {
      background: linear-gradient(135deg, #059669, #047857);
      box-shadow: 0 6px 20px rgba(16,185,129,.4);
    }

    .stats { 
      margin-top: 16px; 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
      gap: 12px; 
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      min-height: 100px;
      opacity: 1;
      visibility: visible;
    }
    .card { 
      padding: 18px; 
      border: 1px solid var(--border); 
      border-radius: 16px; 
      background: var(--card);
      box-shadow: 0 8px 20px rgba(0,0,0,.06);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      min-height: 80px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(0,0,0,.1);
    }
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    .label { color: var(--muted); font-size: .9em; font-weight: 500; }
    .value { font-weight: 800; font-size: 1.4em; margin-top: 4px; color: var(--accent); }

    footer { color: var(--muted); text-align: center; padding: 24px 12px; }

    #adModal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.5); z-index: 9999; }
    .ad-wrap { width: min(720px, 92vw); background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.3); overflow: hidden; }
    .ad-head { padding: 14px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .ad-body { padding: 22px; height: 320px; display: flex; align-items: center; justify-content: center; text-align: center; }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
      .nav { 
        padding: 12px 16px; 
        display: flex; 
        flex-direction: row; 
        justify-content: space-between; 
        align-items: center; 
        gap: 8px; 
        flex-wrap: nowrap;
        overflow: hidden;
      }
      .brand { 
        justify-content: flex-start; 
        flex-direction: row; 
        align-items: center; 
        gap: 0px; 
        flex-shrink: 0;
        min-width: 0;
      }
      .brand-logo { height: 28px; margin-right: 0px; flex-shrink: 0; }
      .brand-text { 
        font-size: 0.7em; 
        text-align: left; 
        white-space: nowrap; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        display: none; 
        margin-left: 0px; 
      }
      .nav-center { display: none; }
      .controls { 
        justify-content: flex-end; 
        margin-left: auto; 
        flex-shrink: 0;
        gap: 6px;
        display: flex;
        align-items: center;
      }
      
      .container { padding: 16px; }
      .hero { gap: 16px; }
      .hero-card { padding: 20px; }
      .title { font-size: 1em; }
      .subtitle { font-size: 0.9em; }
      
      .hero-feature { padding: 16px; }
      .hero-feature-title { font-size: 1em; }
      .hero-feature-desc { font-size: 0.9em; }
      
      .panel { padding: 20px; }
      .row { flex-direction: column; gap: 12px; }
      .primary { padding: 14px 20px; font-size: 1em; }
      
      textarea { 
        min-height: 200px; 
        font-size: 16px; /* Prevents zoom on iOS */
        padding: 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        background: var(--card);
        color: var(--text);
        transition: all 0.3s ease;
      }
      
      textarea:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(37,99,235,.1);
      }
      
      .under-actions { flex-direction: column; gap: 12px; }
      .clear-btn { padding: 12px 20px; }
      
      /* Mobile button optimizations */
      .controls button, .controls select {
        padding: 8px 12px;
        font-size: 0.85em;
        min-width: auto;
      }
      
      .about-link {
        font-size: 0.85em;
        margin-right: 8px !important;
      }
      
      .rules-btn {
        font-size: 0.8em;
        padding: 8px 12px !important;
      }
      
      .stats { 
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
        gap: 16px; 
        margin-top: 20px; 
      }
      .card { padding: 16px; }
      .value { font-size: 1.2em; }
      
      .ad-wrap { width: 95vw; margin: 0 2.5vw; }
      .ad-body { height: 280px; padding: 16px; }
      
      footer { padding: 20px 16px; font-size: 0.9em; }
    }
    
    @media (max-width: 480px) {
      .nav { 
        padding: 10px 12px; 
        flex-direction: row; 
        justify-content: space-between; 
        align-items: center; 
        gap: 6px; 
        flex-wrap: nowrap;
      }
      .brand { 
        justify-content: flex-start; 
        flex-direction: row; 
        align-items: center; 
        gap: 0px; 
        flex-shrink: 0;
      }
      .brand-text { 
        font-size: 0.65em; 
        text-align: left; 
        white-space: nowrap; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        display: none; 
        margin-left: 0px; 
      }
      .nav-center { display: none; }
      .controls { 
        justify-content: flex-end; 
        margin-left: auto; 
        flex-shrink: 0;
        gap: 4px;
      }
      .container { padding: 12px; }
      .hero-card { padding: 16px; }
      .panel { padding: 16px; }
      .title { font-size: 1em; }
      .subtitle { font-size: 0.85em; }
      
      textarea { 
        min-height: 180px; 
        padding: 14px;
        font-size: 16px;
      }
      
      .stats { 
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); 
        gap: 12px; 
      }
      .card { padding: 14px; }
      .value { font-size: 1.1em; }
      .label { font-size: 0.85em; }
      
      .ad-wrap { width: 98vw; margin: 0 1vw; }
      .ad-body { height: 250px; padding: 12px; }
      
      /* Extra small screen button optimizations */
      .controls button, .controls select {
        padding: 6px 10px;
        font-size: 0.8em;
        min-width: auto;
      }
      
      .about-link {
        font-size: 0.8em;
        margin-right: 6px !important;
      }
      
      .rules-btn {
        font-size: 0.75em;
        padding: 6px 10px !important;
      }
    }
    
    @media (max-width: 360px) {
      .nav { 
        gap: 4px; 
        padding: 8px 10px;
      }
      .brand-text { 
        font-size: 0.6em; 
        max-width: 80px; 
        display: none;
      }
      .brand-logo { 
        height: 24px; 
      }
      .controls { 
        gap: 3px;
      }
      .controls button, .controls select {
        padding: 5px 8px;
        font-size: 0.75em;
      }
      .about-link {
        font-size: 0.75em;
        margin-right: 4px !important;
      }
      .rules-btn {
        font-size: 0.7em;
        padding: 5px 8px !important;
      }
      
      .stats { 
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
        gap: 8px; 
      }
    }
    
    .about-link:hover {
      color: #1d4ed8 !important;
    }
  </style>
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "TypeStats",
    "operatingSystem": "Web",
    "applicationCategory": "UtilityApplication",
    "description": "AI-powered multilingual character counter for translation and voice-over professionals. Optimized for voice-over, translation, and localization with smart language rules.",
    "url": "https://typestats.com",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "creator": {
      "@type": "Organization",
      "name": "TypeStats",
      "url": "https://typestats.com"
    },
    "featureList": [
      "Multilingual character counting",
      "AI-powered text analysis",
      "Voice-over script analysis",
      "Translation character counting",
      "Korean language support",
      "Chinese character count",
      "Japanese character count",
      "Thai character count",
      "Smart counting rules",
      "Real-time analysis",
      "Free online tool",
      "GPT text count"
    ],
    "browserRequirements": "Requires JavaScript. Requires HTML5.",
    "softwareVersion": "1.0",
    "datePublished": "2025-01-27",
    "dateModified": "2025-01-27",
    "inLanguage": ["en", "ko", "zh-CN", "zh-TW", "ja", "th", "vi", "ru", "ar", "fr", "de", "es", "pt"],
    "keywords": "character counter, multilingual character count, Chinese character count, voice over script analyzer, text count, Korean count, Japanese count, online count, ai text count, gpt text count, free text count, online text count, script count, 글자수 세기, 글자수 계산기, 한글 글자수, 중문 글자수, 영어 글자수, 일본어 글자수 세기, 여러언어 글자수, 지피티 글자수 세기, 무료 글자수, 온라인 글자수세기, 字数统计器, 中文字数统计, 多语言文本分析, 字数统计, 在线字数, 统计字数, 韩语统计, 日语统计, 泰语统计, 韩语计算, 日语计算, 在线韩语统计, 免费字数统计, 免费统计字数, 免费统计"
  }
  </script>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand">
        <img class="brand-logo" id="logoHome" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTgwIDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8IS0tIERvY3VtZW50IGljb24gLS0+CjxyZWN0IHg9IjIiIHk9IjMiIHdpZHRoPSIxOCIgaGVpZ2h0PSIyNCIgcng9IjIiIGZpbGw9IiMxZTQwYWYiLz4KPHBhdGggZD0iTTE2IDMgTDIwIDcgTDE2IDcgWiIgZmlsbD0iIzBmMTcyYSIgb3BhY2l0eT0iMC4zIi8+CjxyZWN0IHg9IjUiIHk9IjciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxLjIiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjkiLz4KPHJlY3QgeD0iNSIgeT0iOS41IiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjUiIHk9IjEyIiB3aWR0aD0iMTAiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC45Ii8+CjxyZWN0IHg9IjUiIHk9IjE0LjUiIHdpZHRoPSI3IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNyIvPgo8cmVjdCB4PSI1IiB5PSIxNyIgd2lkdGg9IjkiIGhlaWdodD0iMS4yIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+CjxyZWN0IHg9IjUiIHk9IjE5LjUiIHdpZHRoPSI1IiBoZWlnaHQ9IjEuMiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNSIvPgoKPCEtLSBUeXBlU3RhdHMgdGV4dCAtLT4KPHRleHQgeD0iMjYiIHk9IjEyIiBmb250LWZhbWlseT0ic3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmb250LXdlaWdodD0iODAwIiBmaWxsPSIjMWU0MGFmIj5UeXBlPC90ZXh0Pgo8dGV4dCB4PSIyNiIgeT0iMjIiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtd2VpZ2h0PSI4MDAiIGZpbGw9InVybCgjc3RhdHNHcmFkaWVudCkiPlN0YXRzPC90ZXh0PgoKPGRlZnM+CjxsaW5lYXJHcmFkaWVudCBpZD0ic3RhdHNHcmFkaWVudCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMCUiPgo8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMWU0MGFmO3N0b3Atb3BhY2l0eToxIiAvPgo8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwNmI2ZDQ7c3RvcC1vcGFjaXR5OjEiIC8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==" alt="TypeStats Logo" style="cursor: pointer;">
        <div id="brandText" class="brand-text">AI-powered Multilingual Character Counter</div>
      </div>
      <div id="navCenterText" class="nav-center">AI-powered Multilingual Character Counter</div>
      <div class="controls">
        <a href="/about.html" target="_blank" rel="noopener noreferrer" class="about-link" style="margin-right: 16px; color: #2563eb; text-decoration: none; font-weight: 500; transition: color 0.3s;">About</a>
        <button id="contactBtn" class="contact-btn" style="margin-right: 16px; padding: 12px 16px; border-radius: 12px; border: 1px solid var(--border); background: var(--card); color: var(--text); cursor: pointer; font-weight: 500; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,.05);">Contact</button>
        <label for="lang" class="sr-only" style="position:absolute;left:-9999px">Language</label>
        <select id="lang" aria-label="Language"></select>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <div id="adTop" class="ad-slot">
        <!-- Top Banner - TypeStats -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8559690324489971"
             data-ad-slot="3634322089"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <div class="hero">
        <div class="hero-card">
          <h1 class="title" id="title">Multilingual Character Counter</h1>
          <p class="subtitle" id="subtitle">Analyze scripts with language-specific intelligence—accurate counts for Korean, Chinese, English, and more.</p>
        </div>
        <div class="hero-card">
          <h2 class="sr-only">Key Features</h2>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
            <div class="hero-feature">
              <h3 class="hero-feature-title" id="hi1">AI Precision</h3>
              <p class="hero-feature-desc" id="hi1s">Language-aware counts for characters, words, digits, and punctuation—tailored for each script.</p>
            </div>
            <div class="hero-feature">
              <h3 class="hero-feature-title" id="hi2">Smart Rules</h3>
              <p class="hero-feature-desc" id="hi2s">Applies Korean-focused or multilingual rules dynamically. Perfect for bilingual scripts.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <h2 class="sr-only" id="analysisToolTitle">Text Analysis Tool</h2>
        <div class="row">
          <button id="pasteBtnTop" class="primary" type="button">Paste text</button>
          <button id="rulesBtn" class="rules-btn" type="button" style="display: block !important; visibility: visible !important; background: #10b981; color: white; border: none; padding: 12px 16px; border-radius: 12px; font-weight: 600; cursor: pointer;">📊 Counting Rules</button>
        </div>

        <label for="textInput" class="sr-only" id="textInputLabel">Enter text to analyze</label>
        <textarea id="textInput" placeholder="Type or paste your text…" aria-label="Text input for character counting analysis"></textarea>
        <div class="under-actions">
          <button id="clearBtn" class="clear-btn" type="button">Clear</button>
        </div>

        <div id="adInline" class="ad-slot">
          <!-- Inline Banner - TypeStats -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-8559690324489971"
               data-ad-slot="5824537000"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>

        <div id="result" style="margin-top: 12px; min-height: 120px; background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 16px; display: flex; align-items: center; justify-content: center;" role="region" aria-label="Character count analysis results">
          <div style="color: var(--muted); font-style: italic; text-align: center;">
            Enter text to see character count analysis results here.
          </div>
        </div>

        <div id="adFooter" class="ad-slot">
          <!-- Footer Banner - TypeStats -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-8559690324489971"
               data-ad-slot="3077301779"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
    </div>
  </main>

  <footer>
    © 2025 Type Stats. All rights reserved.
  </footer>

  <div id="adModal">
    <div class="ad-wrap">
      <div class="ad-head">
        <div style="font-weight:700">Notice</div>
        <button id="adClose" type="button" style="padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:transparent;cursor:pointer">Close</button>
      </div>
      <div class="ad-body" id="adMessage">
        <!-- typestats-pop-up -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8559690324489971"
             data-ad-slot="8708902408"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>
  </div>

  <!-- Rules Modal -->
  <div id="rulesModal" style="position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.5); z-index: 9999;">
    <div class="rules-wrap" style="width: min(800px, 90vw); max-height: 80vh; background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.3); overflow: hidden;">
      <div class="rules-head" style="padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0; font-weight: 700; color: var(--text);">📊 Character Counting Rules</h3>
        <button id="rulesClose" type="button" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; background: transparent; cursor: pointer; color: var(--text);">✕</button>
      </div>
      <div class="rules-body" style="padding: 24px; overflow-y: auto; max-height: 60vh;">
        <div class="rules-content">
          <h4 style="color: var(--accent); margin-bottom: 16px;">🌍 Language-Specific Counting Rules</h4>
          
          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">🇺🇸 English Words</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Hyphenated words:</strong> <code>player-driven</code>, <code>top-tier</code> → <strong>1 word</strong> (not 2)</li>
              <li><strong>Contractions:</strong> <code>don't</code>, <code>isn't</code> → <strong>1 word</strong></li>
              <li><strong>Numbers + letters:</strong> <code>MU666</code>, <code>24/7</code> → <strong>1 word</strong></li>
              <li><strong>Word boundaries:</strong> Properly detects word boundaries using Unicode-aware regex</li>
            </ul>
            <div style="background: var(--bg2); padding: 12px; border-radius: 8px; margin-top: 8px; font-size: 0.9em; color: var(--muted);">
              <strong>Note:</strong> This differs from Microsoft Word/Pages which may count hyphenated words as separate words.
            </div>
          </div>

          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">🇰🇷 Korean Characters</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Hangul syllables:</strong> <code>안녕하세요</code> → <strong>5 characters</strong></li>
              <li><strong>Mixed content:</strong> Korean + English uses special counting rules</li>
              <li><strong>Spaces excluded:</strong> Only actual characters are counted</li>
            </ul>
          </div>

          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">🇨🇳 Chinese Characters</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Han characters:</strong> <code>你好世界</code> → <strong>4 characters</strong></li>
              <li><strong>Simplified & Traditional:</strong> Both variants supported</li>
              <li><strong>Punctuation:</strong> Chinese punctuation marks counted separately</li>
            </ul>
          </div>

          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">🇯🇵 Japanese Characters</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Hiragana + Katakana:</strong> Combined as "Japanese" category</li>
              <li><strong>Kanji:</strong> Counted as Chinese characters</li>
              <li><strong>Mixed scripts:</strong> Properly separated and counted</li>
            </ul>
          </div>

          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">🔢 Numbers & Punctuation</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Digits:</strong> <code>0-9</code> counted separately</li>
              <li><strong>Punctuation:</strong> All Unicode punctuation marks</li>
              <li><strong>Special characters:</strong> Symbols, emojis, etc.</li>
            </ul>
          </div>

          <div class="rule-section" style="margin-bottom: 24px;">
            <h5 style="color: var(--text); margin-bottom: 12px;">⚖️ Total Count Logic</h5>
            <ul style="margin: 0; padding-left: 20px; color: var(--text);">
              <li><strong>Korean-dominant text:</strong> All characters (spaces excluded)</li>
              <li><strong>Other languages:</strong> Script characters + English words + digits</li>
              <li><strong>Punctuation:</strong> Excluded from total count</li>
            </ul>
          </div>

          <div style="background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: white; padding: 16px; border-radius: 12px; margin-top: 24px;">
            <h5 style="margin: 0 0 8px; color: white;">💡 Why This Matters</h5>
            <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">
              Accurate character counting is crucial for voice-over timing, translation pricing, and content optimization. 
              Our AI-powered rules ensure consistency across all supported languages.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Contact Modal -->
  <div id="contactModal" style="position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.5); z-index: 9999;">
    <div class="contact-wrap" style="width: min(500px, 90vw); background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.3); overflow: hidden;">
      <div class="contact-head" style="padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0; font-weight: 700; color: var(--text);">Contact Developer</h3>
        <button id="contactClose" type="button" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; background: transparent; cursor: pointer; color: var(--text);">✕</button>
      </div>
      <div class="contact-body" style="padding: 24px;">
        <form id="contactForm">
          <div style="margin-bottom: 16px;">
            <label for="contactEmail" style="display: block; margin-bottom: 6px; font-weight: 500; color: var(--text);">Email *</label>
            <input type="email" id="contactEmail" required style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--card); color: var(--text); font-size: 14px; box-sizing: border-box;">
          </div>
          <div style="margin-bottom: 16px;">
            <label for="contactPhone" style="display: block; margin-bottom: 6px; font-weight: 500; color: var(--text);">Phone (Optional)</label>
            <input type="tel" id="contactPhone" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--card); color: var(--text); font-size: 14px; box-sizing: border-box;">
          </div>
          <div style="margin-bottom: 20px;">
            <label for="contactMessage" style="display: block; margin-bottom: 6px; font-weight: 500; color: var(--text);">Message *</label>
            <textarea id="contactMessage" required rows="4" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--card); color: var(--text); font-size: 14px; resize: vertical; box-sizing: border-box; font-family: inherit;"></textarea>
          </div>
          <div style="display: flex; gap: 12px; justify-content: flex-end;">
            <button type="button" id="contactCancel" style="padding: 12px 20px; border: 1px solid var(--border); border-radius: 8px; background: transparent; color: var(--text); cursor: pointer; font-weight: 500;">Cancel</button>
            <button type="submit" style="padding: 12px 20px; border: none; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: white; cursor: pointer; font-weight: 500; box-shadow: 0 4px 12px rgba(37,99,235,.3);">Send Message</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Basic regexes
    const RX = {
      punct: /\p{P}/gu,
      latin: /[A-Za-z]/g,
      ew: /(?<![A-Za-z0-9])[A-Za-z0-9'-]*[A-Za-z][A-Za-z0-9'-]*(?![A-Za-z0-9])/g,
      han: /\p{Script=Han}/gu,
      hangul: /\p{Script=Hangul}/gu,
      hira: /\p{Script=Hiragana}/gu,
      kata: /\p{Script=Katakana}/gu,
      thai: /\p{Script=Thai}/gu,
      arab: /\p{Script=Arabic}/gu,
      deva: /\p{Script=Devanagari}/gu,
      cyrl: /\p{Script=Cyrillic}/gu,
      greek:/\p{Script=Greek}/gu,
      hebr: /\p{Script=Hebrew}/gu
    };

    // Normalize pasted text (top and tail cleanup)
    function normalizePasted(text) {
      return text
        .replace(/\r\n?/g, '\n')
        .replace(/^\s*\n+/, '')
        .replace(/\n{3,}/g, '\n\n')
        .replace(/\s+$/g, '');
    }

    // i18n (UI + labels + script names)
    const i18n = {
      ui: {
        en:{title:'Multilingual Character Counter',subtitle:'Analyze scripts with language-specific intelligence—accurate counts for Korean, Chinese, English, and more.',paste:'Paste text',clear:'Clear',rules:'📊 Counting Rules',placeholder:'Type or paste your text…',hi1:'AI Precision',hi1s:'Language-aware counts for characters, words, digits, and punctuation—tailored for each script.',hi2:'Smart Rules',hi2s:'Applies Korean-focused or multilingual rules dynamically. Perfect for bilingual scripts.',brand:'AI-powered Multilingual Character Counter',analysisTool:'Multilingual Text Analyzer',textInputLabel:'Automatically detects languages and counts characters by language with AI precision.',contact:'Contact',contactTitle:'Contact Developer',contactEmail:'Email *',contactPhone:'Phone (Optional)',contactMessage:'Message *',contactCancel:'Cancel',contactSend:'Send Message',contactSuccess:'Your email client will open with the message. Please send the email to complete your inquiry.',placeholderMessage:'Enter text to see character count analysis results here.'},
        ko:{title:'다국어 글자수세기',subtitle:'AI가 계산하는 정확한 글자수, 콘텐츠 품질의 시작입니다.',paste:'텍스트 붙여넣기',clear:'지우기',rules:'📊 통계 규칙',placeholder:'텍스트를 입력하거나 붙여넣으세요…',hi1:'AI 정밀도',hi1s:'언어별 글자·단어·숫자·문장부호 집계.',hi2:'스마트 규칙',hi2s:'한국어 최다 시 특수 규칙, 그 외 통일 규칙.',brand:'언어별 규칙에 맞춘 AI 기반 글자수 분석기',analysisTool:'다국어 텍스트 분석기',textInputLabel:'AI가 텍스트 속 언어를 자동으로 감지하고, 언어별로 정확하게 글자 수를 분석합니다.',contact:'Contact',contactTitle:'개발자에게 연락하기',contactEmail:'이메일 *',contactPhone:'연락처 (선택사항)',contactMessage:'문의 내용 *',contactCancel:'취소',contactSend:'메시지 보내기',contactSuccess:'이메일 클라이언트가 열립니다. 이메일을 보내주시면 문의가 완료됩니다.',placeholderMessage:'텍스트를 입력하면 글자수 분석 결과가 여기에 표시됩니다.'},
        'zh-CN':{title:'多语言字符统计专家',subtitle:'基于语言识别的AI引擎，精准统计韩语、中文、英语等多语脚本中的字数或单词。',paste:'粘贴文本',clear:'清空',rules:'📊 统计规则',placeholder:'输入或粘贴文本…',hi1:'AI精准解析',hi1s:'按语言类型智能识别字数、词语、数字与符号，确保每一项统计结果准确可靠。',hi2:'智能统计规则',hi2s:'灵活切换韩语优先或统一标准，专为双语及多语言剧本优化设计。',brand:'AI智能驱动的多语言字数统计工具',analysisTool:'多语言文本分析器',textInputLabel:'通过 AI 自动识别语言，并按语言类型精准统计字数。',contact:'Contact',contactTitle:'联系开发者',contactEmail:'邮箱 *',contactPhone:'电话 (可选)',contactMessage:'消息 *',contactCancel:'取消',contactSend:'发送消息',contactSuccess:'您的邮件客户端将打开。请发送邮件以完成您的询问。',placeholderMessage:'输入文本以查看字符计数分析结果。'},
        'zh-TW':{title:'多語文字元統計專家',subtitle:'基於語言識別的AI引擎，精準統計韓語、中文、英語等多語腳本中的字數或單詞。',paste:'貼上文字',clear:'清除',rules:'📊 統計規則',placeholder:'輸入或貼上文字…',hi1:'AI精準解析',hi1s:'按語言類型智能識別字數、詞語、數字與符號，確保每一項統計結果準確可靠。',hi2:'智能統計規則',hi2s:'靈活切換韓語優先或統一標準，專為雙語及多語言劇本優化設計。',brand:'AI智能驅動的多語言字數統計工具',analysisTool:'多語言文本分析器',textInputLabel:'透過 AI 自動偵測語言，並依語言類型精準統計字數。',contact:'Contact',contactTitle:'聯繫開發者',contactEmail:'郵箱 *',contactPhone:'電話 (可選)',contactMessage:'消息 *',contactCancel:'取消',contactSend:'發送消息',contactSuccess:'您的郵件客戶端將打開。請發送郵件以完成您的詢問。',placeholderMessage:'輸入文字以查看字符計數分析結果。'},
        ja:{title:'多言語文字数カウンター',subtitle:'言語固有の知能でスクリプトを分析——韓国語、中国語、英語など正確なカウント。',paste:'テキストを貼り付け',clear:'クリア',rules:'📊 カウント規則',placeholder:'テキストを入力/貼り付け…',hi1:'AI精密',hi1s:'各スクリプトに合わせた文字、単語、数字、句読点の言語認識カウント。',hi2:'スマート規則',hi2s:'韓国語重点または多言語規則を動的に適用。バイリンガルスクリプトに最適。',brand:'AI駆動多言語文字数カウンター',analysisTool:'多言語テキストアナライザー',textInputLabel:'AI が言語を自動検出し、言語ごとに正確な文字数をカウントします。',contact:'Contact',contactTitle:'開発者に連絡',contactEmail:'メール *',contactPhone:'電話 (オプション)',contactMessage:'メッセージ *',contactCancel:'キャンセル',contactSend:'メッセージを送信',contactSuccess:'メールクライアントが開きます。メールを送信して問い合わせを完了してください。',placeholderMessage:'テキストを入力すると文字数分析結果がここに表示されます。'},
        th:{title:'ตัวนับอักขระหลายภาษา',subtitle:'วิเคราะห์สคริปต์ด้วยความฉลาดเฉพาะภาษา—นับที่แม่นยำสำหรับเกาหลี จีน อังกฤษ และอื่นๆ',paste:'วางข้อความ',clear:'ล้าง',rules:'📊 กฎการนับ',placeholder:'พิมพ์หรือวางข้อความ…',hi1:'AI ความแม่นยำ',hi1s:'นับอักขระ คำ ตัวเลข เครื่องหมายวรรคตอนที่รู้จักภาษา—ปรับให้เหมาะกับแต่ละสคริปต์',hi2:'กฎอัจฉริยะ',hi2s:'ใช้กฎเน้นเกาหลีหรือหลายภาษาอย่างไดนามิก เหมาะสำหรับสคริปต์สองภาษา',brand:'ตัวนับอักขระหลายภาษาที่ขับเคลื่อนด้วย AI',analysisTool:'เครื่องวิเคราะห์ข้อความหลายภาษา',textInputLabel:'AI ตรวจจับภาษาอัตโนมัติและนับอักขระตามภาษาด้วยความแม่นยำ',contact:'Contact',contactTitle:'ติดต่อนักพัฒนา',contactEmail:'อีเมล *',contactPhone:'โทรศัพท์ (ไม่บังคับ)',contactMessage:'ข้อความ *',contactCancel:'ยกเลิก',contactSend:'ส่งข้อความ',contactSuccess:'ไคลเอนต์อีเมลของคุณจะเปิดขึ้น กรุณาส่งอีเมลเพื่อทำการสอบถามให้เสร็จสิ้น',placeholderMessage:'ป้อนข้อความเพื่อดูผลการวิเคราะห์จำนวนตัวอักษรที่นี่'},
        vi:{title:'Bộ đếm ký tự đa ngôn ngữ',subtitle:'Phân tích kịch bản với trí tuệ đặc thù ngôn ngữ—đếm chính xác cho Hàn, Trung, Anh và hơn thế.',paste:'Dán văn bản',clear:'Xóa',rules:'📊 Quy tắc đếm',placeholder:'Nhập hoặc dán văn bản…',hi1:'AI Chính xác',hi1s:'Đếm ký tự, từ, số, dấu câu nhận biết ngôn ngữ—tùy chỉnh cho từng kịch bản.',hi2:'Quy tắc thông minh',hi2s:'Áp dụng động quy tắc tập trung Hàn Quốc hoặc đa ngôn ngữ. Hoàn hảo cho kịch bản song ngữ.',brand:'Bộ đếm ký tự đa ngôn ngữ được AI hỗ trợ',analysisTool:'Trình phân tích văn bản đa ngôn ngữ',textInputLabel:'AI tự động phát hiện ngôn ngữ và đếm ký tự theo ngôn ngữ với độ chính xác cao.',contact:'Contact',contactTitle:'Liên hệ nhà phát triển',contactEmail:'Email *',contactPhone:'Điện thoại (Tùy chọn)',contactMessage:'Tin nhắn *',contactCancel:'Hủy',contactSend:'Gửi tin nhắn',contactSuccess:'Ứng dụng email của bạn sẽ mở. Vui lòng gửi email để hoàn thành yêu cầu của bạn.',placeholderMessage:'Nhập văn bản để xem kết quả phân tích số ký tự ở đây.'},
        ru:{title:'Многоязычный счётчик символов',subtitle:'Анализ скриптов с языковой специфической интеллектуальностью—точный подсчёт для корейского, китайского, английского и других.',paste:'Вставить текст',clear:'Очистить',rules:'📊 Правила подсчёта',placeholder:'Введите или вставьте текст…',hi1:'AI Точность',hi1s:'Языково-осведомлённый подсчёт символов, слов, цифр и пунктуации—настроенный для каждого скрипта.',hi2:'Умные правила',hi2s:'Динамически применяет корейско-ориентированные или многоязычные правила. Идеально для двуязычных скриптов.',brand:'Многоязычный счётчик символов на базе ИИ',analysisTool:'Многоязычный анализатор текста',textInputLabel:'AI автоматически определяет языки и подсчитывает символы по языкам с высокой точностью.',contact:'Contact',contactTitle:'Связаться с разработчиком',contactEmail:'Email *',contactPhone:'Телефон (Необязательно)',contactMessage:'Сообщение *',contactCancel:'Отмена',contactSend:'Отправить сообщение',contactSuccess:'Ваш почтовый клиент откроется. Пожалуйста, отправьте email для завершения вашего запроса.',placeholderMessage:'Введите текст, чтобы увидеть результаты анализа количества символов здесь.'},
        ar:{title:'عداد الأحرف متعدد اللغات',subtitle:'تحليل النصوص بذكاء خاص باللغة—عد دقيق للكورية والصينية والإنجليزية والمزيد.',paste:'لصق النص',clear:'مسح',rules:'📊 قواعد العد',placeholder:'اكتب أو الصق النص…',hi1:'دقة الذكاء الاصطناعي',hi1s:'عد الأحرف والكلمات والأرقام وعلامات الترقيم الواعي باللغة—مخصص لكل نص.',hi2:'قواعد ذكية',hi2s:'يطبق قواعد مركزة على الكورية أو متعددة اللغات ديناميكياً. مثالي للنصوص ثنائية اللغة.',brand:'عداد الأحرف متعدد اللغات مدعوم بالذكاء الاصطناعي',analysisTool:'محلل النصوص متعدد اللغات',textInputLabel:'AI يكتشف اللغات تلقائياً ويعد الأحرف حسب اللغة بدقة عالية.',contact:'Contact',contactTitle:'اتصل بالمطور',contactEmail:'البريد الإلكتروني *',contactPhone:'الهاتف (اختياري)',contactMessage:'الرسالة *',contactCancel:'إلغاء',contactSend:'إرسال الرسالة',contactSuccess:'سيتم فتح عميل البريد الإلكتروني الخاص بك. يرجى إرسال البريد الإلكتروني لإكمال استفسارك.',placeholderMessage:'أدخل النص لرؤية نتائج تحليل عدد الأحرف هنا.'},
        fr:{title:'Compteur de caractères multilingue',subtitle:'Analysez les scripts avec une intelligence spécifique à la langue—comptes précis pour le coréen, chinois, anglais et plus.',paste:'Coller le texte',clear:'Effacer',rules:'📊 Règles de comptage',placeholder:'Saisissez ou collez du texte…',hi1:'Précision IA',hi1s:'Comptes conscients de la langue pour caractères, mots, chiffres et ponctuation—adaptés à chaque script.',hi2:'Règles intelligentes',hi2s:'Applique dynamiquement des règles centrées sur le coréen ou multilingues. Parfait pour les scripts bilingues.',brand:'Compteur de caractères multilingue alimenté par IA',analysisTool:'Analyseur de texte multilingue',textInputLabel:'IA détecte automatiquement les langues et compte les caractères par langue avec précision.',contact:'Contact',contactTitle:'Contacter le développeur',contactEmail:'Email *',contactPhone:'Téléphone (Optionnel)',contactMessage:'Message *',contactCancel:'Annuler',contactSend:'Envoyer le message',contactSuccess:'Votre client email s ouvrira. Veuillez envoyer l email pour compléter votre demande.',placeholderMessage:'Entrez du texte pour voir les résultats d analyse du nombre de caractères ici.'},
        de:{title:'Mehrsprachiger Zeichenzähler',subtitle:'Analysieren Sie Skripte mit sprachspezifischer Intelligenz—genaue Zählungen für Koreanisch, Chinesisch, Englisch und mehr.',paste:'Text einfügen',clear:'Löschen',rules:'📊 Zählregeln',placeholder:'Text eingeben oder einfügen…',hi1:'KI-Präzision',hi1s:'Sprachbewusste Zählungen für Zeichen, Wörter, Ziffern und Interpunktion—angepasst an jedes Skript.',hi2:'Smarte Regeln',hi2s:'Wendet dynamisch koreanisch-fokussierte oder mehrsprachige Regeln an. Perfekt für zweisprachige Skripte.',brand:'KI-gestützter mehrsprachiger Zeichenzähler',analysisTool:'Mehrsprachiger Textanalysator',textInputLabel:'KI erkennt automatisch Sprachen und zählt Zeichen nach Sprache mit hoher Präzision.',contact:'Contact',contactTitle:'Entwickler kontaktieren',contactEmail:'E-Mail *',contactPhone:'Telefon (Optional)',contactMessage:'Nachricht *',contactCancel:'Abbrechen',contactSend:'Nachricht senden',contactSuccess:'Ihr E-Mail-Client wird geöffnet. Bitte senden Sie die E-Mail, um Ihre Anfrage abzuschließen.',placeholderMessage:'Geben Sie Text ein, um Zeichenzählungsanalyseergebnisse hier zu sehen.'},
        es:{title:'Contador de caracteres multilingüe',subtitle:'Analiza scripts con inteligencia específica del idioma—conteos precisos para coreano, chino, inglés y más.',paste:'Pegar texto',clear:'Borrar',rules:'📊 Reglas de conteo',placeholder:'Escribe o pega texto…',hi1:'Precisión IA',hi1s:'Conteos conscientes del idioma para caracteres, palabras, dígitos y puntuación—adaptados a cada script.',hi2:'Reglas inteligentes',hi2s:'Aplica dinámicamente reglas centradas en coreano o multilingües. Perfecto para scripts bilingües.',brand:'Contador de caracteres multilingüe impulsado por IA',analysisTool:'Analizador de texto multilingüe',textInputLabel:'IA detecta automáticamente idiomas y cuenta caracteres por idioma con precisión.',contact:'Contact',contactTitle:'Contactar desarrollador',contactEmail:'Email *',contactPhone:'Teléfono (Opcional)',contactMessage:'Mensaje *',contactCancel:'Cancelar',contactSend:'Enviar mensaje',contactSuccess:'Su cliente de correo se abrirá. Por favor envíe el correo para completar su consulta.',placeholderMessage:'Ingrese texto para ver los resultados del análisis de conteo de caracteres aquí.'},
        pt:{title:'Contador de caracteres multilíngue',subtitle:'Analise scripts com inteligência específica da linguagem—contagens precisas para coreano, chinês, inglês e mais.',paste:'Colar texto',clear:'Limpar',rules:'📊 Regras de contagem',placeholder:'Digite ou cole o texto…',hi1:'Precisão IA',hi1s:'Contagens conscientes da linguagem para caracteres, palavras, dígitos e pontuação—adaptadas a cada script.',hi2:'Regras inteligentes',hi2s:'Aplica dinamicamente regras focadas no coreano ou multilíngues. Perfeito para scripts bilíngues.',brand:'Contador de caracteres multilíngue alimentado por IA',analysisTool:'Analisador de texto multilíngue',textInputLabel:'IA detecta automaticamente idiomas e conta caracteres por idioma com precisão.',contact:'Contact',contactTitle:'Contatar desenvolvedor',contactEmail:'Email *',contactPhone:'Telefone (Opcional)',contactMessage:'Mensagem *',contactCancel:'Cancelar',contactSend:'Enviar mensagem',contactSuccess:'Seu cliente de email será aberto. Por favor envie o email para completar sua consulta.',placeholderMessage:'Digite texto para ver os resultados da análise de contagem de caracteres aqui.'}
      },
      labels: {
        en:{scriptChars:n=>`${n} characters`,enLetters:'English letters',enWords:'English words',digits:'Digits',punct:'Punctuation',total:'Total (no spaces)',noPunct:'no punctuation'},
        ko:{scriptChars:n=>`${n} 글자수`,enLetters:'영어 글자수',enWords:'영어 단어 수',digits:'숫자',punct:'문장부호',total:'전체 글자수 (공백 제외)',noPunct:'문장부호 제외'},
        'zh-CN':{scriptChars:n=>`${n} 字数`,enLetters:'英文字母数',enWords:'英文单词数',digits:'数字',punct:'标点符号',total:'总字数（去空白）',noPunct:'不含标点'},
        'zh-TW':{scriptChars:n=>`${n} 字数`,enLetters:'英文字母數',enWords:'英文單字數',digits:'數字',punct:'標點符號',total:'總字数（去空白）',noPunct:'不含標點'},
        ja:{scriptChars:n=>`${n} 文字数`,enLetters:'英語の文字数',enWords:'英語の単語数',digits:'数字',punct:'句読点',total:'総文字数（空白除く）',noPunct:'句読点除く'},
        th:{scriptChars:n=>`${n} ตัวอักษร`,enLetters:'ตัวอักษรอังกฤษ',enWords:'คำภาษาอังกฤษ',digits:'ตัวเลข',punct:'เครื่องหมายวรรคตอน',total:'รวม (ไม่รวมช่องว่าง)',noPunct:'ไม่รวมเครื่องหมาย'},
        vi:{scriptChars:n=>`${n} ký tự`,enLetters:'Chữ cái tiếng Anh',enWords:'Từ tiếng Anh',digits:'Chữ số',punct:'Dấu câu',total:'Tổng (không tính khoảng trắng)',noPunct:'không tính dấu câu'},
        ru:{scriptChars:n=>`${n} символов`,enLetters:'Английские буквы',enWords:'Английские слова',digits:'Цифры',punct:'Знаки препинания',total:'Всего (без пробелов)',noPunct:'без пунктуации'},
        ar:{scriptChars:n=>`${n} حرف`,enLetters:'حروف إنجليزية',enWords:'كلمات إنجليزية',digits:'أرقام',punct:'علامات ترقيم',total:'الإجمالي (بدون مسافات)',noPunct:'بدون ترقيم'},
        fr:{scriptChars:n=>`${n} caractères`,enLetters:'Lettres anglaises',enWords:'Mots anglais',digits:'Chiffres',punct:'Ponctuation',total:'Total (sans espaces)',noPunct:'sans ponctuation'},
        de:{scriptChars:n=>`${n} Zeichen`,enLetters:'Englische Buchstaben',enWords:'Englische Wörter',digits:'Ziffern',punct:'Zeichensetzung',total:'Gesamt (ohne Leerzeichen)',noPunct:'ohne Interpunktion'},
        es:{scriptChars:n=>`${n} caracteres`,enLetters:'Letras en inglés',enWords:'Palabras en inglés',digits:'Dígitos',punct:'Puntuación',total:'Total (sin espacios)',noPunct:'sin puntuación'},
        pt:{scriptChars:n=>`${n} caracteres`,enLetters:'Letras em inglês',enWords:'Palavras em inglês',digits:'Dígitos',punct:'Pontuação',total:'Total (sem espaços)',noPunct:'sem pontuação'}
      },
      scripts: {
        en:{Korean:'Korean',Chinese:'Chinese',Japanese:'Japanese',Thai:'Thai',Arabic:'Arabic',Devanagari:'Hindi',Cyrillic:'Cyrillic',Greek:'Greek',Hebrew:'Hebrew'},
        ko:{Korean:'한국어',Chinese:'중국어',Japanese:'일본어',Thai:'태국어',Arabic:'아랍어',Devanagari:'힌디어',Cyrillic:'키릴 문자',Greek:'그리스어',Hebrew:'히브리어'},
        'zh-CN':{Korean:'韩语',Chinese:'中文',Japanese:'日语',Thai:'泰语',Arabic:'阿拉伯语',Devanagari:'印地语',Cyrillic:'西里尔文',Greek:'希腊语',Hebrew:'希伯来语'},
        'zh-TW':{Korean:'韓語',Chinese:'中文',Japanese:'日語',Thai:'泰語',Arabic:'阿拉伯語',Devanagari:'印地語',Cyrillic:'西里爾文',Greek:'希臘語',Hebrew:'希伯來語'},
        ja:{Korean:'韓国語',Chinese:'中国語',Japanese:'日本語',Thai:'タイ語',Arabic:'アラビア語',Devanagari:'ヒンディー語',Cyrillic:'キリル文字',Greek:'ギリシャ語',Hebrew:'ヘブライ語'},
        th:{Korean:'เกาหลี',Chinese:'จีน',Japanese:'ญี่ปุ่น',Thai:'ไทย',Arabic:'อาหรับ',Devanagari:'ฮินดี',Cyrillic:'ซีริลลิก',Greek:'กรีก',Hebrew:'ฮีบรู'},
        vi:{Korean:'Hàn',Chinese:'Trung',Japanese:'Nhật',Thai:'Thái',Arabic:'Ả Rập',Devanagari:'Hindi',Cyrillic:'Chữ Kirin',Greek:'Hy Lạp',Hebrew:'Do Thái'},
        ru:{Korean:'Корейский',Chinese:'Китайский',Japanese:'Японский',Thai:'Тайский',Arabic:'Арабский',Devanagari:'Хинди',Cyrillic:'Кириллица',Greek:'Греческий',Hebrew:'Иврит'},
        ar:{Korean:'الكورية',Chinese:'الصينية',Japanese:'اليابانية',Thai:'التايلاندية',Arabic:'العربية',Devanagari:'الهندية',Cyrillic:'السيريلية',Greek:'اليونانية',Hebrew:'العبرية'},
        fr:{Korean:'Coréen',Chinese:'Chinois',Japanese:'Japonais',Thai:'Thaï',Arabic:'Arabe',Devanagari:'Hindi',Cyrillic:'Cyrillique',Greek:'Grec',Hebrew:'Hébreu'},
        de:{Korean:'Koreanisch',Chinese:'Chinesisch',Japanese:'Japanisch',Thai:'Thailändisch',Arabic:'Arabisch',Devanagari:'Hindi',Cyrillic:'Kyrillisch',Greek:'Griechisch',Hebrew:'Hebräisch'},
        es:{Korean:'Coreano',Chinese:'Chino',Japanese:'Japonés',Thai:'Tailandés',Arabic:'Árabe',Devanagari:'Hindi',Cyrillic:'Cirílico',Greek:'Griego',Hebrew:'Hebreo'},
        pt:{Korean:'Coreano',Chinese:'Chinês',Japanese:'Japonês',Thai:'Tailandês',Arabic:'Árabe',Devanagari:'Hindi',Cyrillic:'Cirílico',Greek:'Grego',Hebrew:'Hebraico'}
      }
    };

    const langOrder = ['en','ko','zh-CN','zh-TW','ja','th','vi','ru','ar','fr','de','es','pt'];

    // Analytics tracking functions
    function trackCharacterCount(text, stats, uiLang) {
      if (!text || text.trim().length === 0) return;
      
      const textLength = text.length;
      const primaryLanguage = stats.primary.key || 'Unknown';
      const totalCount = stats.total;
      
      // Track character counting event with detailed language info
      gtag('event', 'character_count', {
        'event_category': 'text_analysis',
        'event_label': primaryLanguage,
        'value': totalCount,
        'language_detected': primaryLanguage,
        'character_count': totalCount,
        'text_length': textLength,
        'ui_language': uiLang
      });
      
      // Track specific language detection
      gtag('event', 'language_detected', {
        'event_category': 'language_analysis',
        'event_label': primaryLanguage,
        'value': stats.counts[primaryLanguage] || 0,
        'detected_language': primaryLanguage,
        'language_count': stats.counts[primaryLanguage] || 0
      });
      
      // Track UI language selection
      gtag('event', 'ui_language_selected', {
        'event_category': 'user_preference',
        'event_label': uiLang,
        'value': 1,
        'selected_ui_language': uiLang
      });
      
      // Track all detected languages in the text
      Object.entries(stats.counts).forEach(([lang, count]) => {
        if (count > 0) {
          gtag('event', 'language_usage', {
            'event_category': 'language_breakdown',
            'event_label': lang,
            'value': count,
            'language_type': lang,
            'character_count': count
          });
        }
      });
      
    }
    
    function trackUserAction(action, details = {}) {
      gtag('event', action, {
        'event_category': 'user_interaction',
        'event_label': details.label || action,
        'value': details.value || 1
      });
    }
    

    function localScriptName(key, uiLang) {
      const m = i18n.scripts[uiLang] || i18n.scripts.en;
      return m[key] || key;
    }

    function setUILanguage(lang) {
      const u = i18n.ui[lang] || i18n.ui.en;
      document.documentElement.lang = lang;
      document.getElementById('brandText').textContent = u.brand;
      document.getElementById('navCenterText').textContent = u.brand;
      document.getElementById('title').textContent = u.title;
      document.getElementById('subtitle').textContent = u.subtitle;
      document.getElementById('textInput').placeholder = u.placeholder;
      document.getElementById('hi1').textContent = u.hi1;
      document.getElementById('hi1s').textContent = u.hi1s;
      document.getElementById('hi2').textContent = u.hi2;
      document.getElementById('hi2s').textContent = u.hi2s;
      document.getElementById('pasteBtnTop').textContent = u.paste;
      document.getElementById('clearBtn').textContent = u.clear;
      if (document.getElementById('rulesBtn')) {
        document.getElementById('rulesBtn').textContent = u.rules || '📊 Counting Rules';
      }
      // Update new fields
      if (document.getElementById('analysisToolTitle')) {
        document.getElementById('analysisToolTitle').textContent = u.analysisTool || 'Text Analysis Tool';
      }
      if (document.getElementById('textInputLabel')) {
        document.getElementById('textInputLabel').textContent = u.textInputLabel || 'Enter text to analyze';
      }
      // Update contact button and modal
      if (document.getElementById('contactBtn')) {
        document.getElementById('contactBtn').textContent = u.contact || 'Contact';
      }
      if (document.querySelector('.contact-head h3')) {
        document.querySelector('.contact-head h3').textContent = u.contactTitle || 'Contact Developer';
      }
      if (document.querySelector('label[for="contactEmail"]')) {
        document.querySelector('label[for="contactEmail"]').textContent = u.contactEmail || 'Email *';
      }
      if (document.querySelector('label[for="contactPhone"]')) {
        document.querySelector('label[for="contactPhone"]').textContent = u.contactPhone || 'Phone (Optional)';
      }
      if (document.querySelector('label[for="contactMessage"]')) {
        document.querySelector('label[for="contactMessage"]').textContent = u.contactMessage || 'Message *';
      }
      if (document.getElementById('contactCancel')) {
        document.getElementById('contactCancel').textContent = u.contactCancel || 'Cancel';
      }
      if (document.querySelector('#contactForm button[type="submit"]')) {
        document.querySelector('#contactForm button[type="submit"]').textContent = u.contactSend || 'Send Message';
      }
      onInput();
    }

    function countNonEmptyLines(text) {
      const normalized = text.replace(/\r\n?/g, '\n');
      if (!normalized) return 0;
      return normalized.split('\n').filter(l => l.trim().length > 0).length;
    }

    function analyze(text, uiLang) {
      const noSpaces = text.replace(/\s+/g, '');
      const englishLetters = (noSpaces.match(RX.latin) || []).length;
      const englishWords = (text.match(RX.ew) || []).length;
      const digits = (noSpaces.match(/[0-9]/g) || []).length;
      const punct = (noSpaces.match(RX.punct) || []).length;

      const counts = {
        Korean: (noSpaces.match(RX.hangul) || []).length,
        Chinese: (noSpaces.match(RX.han) || []).length,
        Hiragana: (noSpaces.match(RX.hira) || []).length,
        Katakana: (noSpaces.match(RX.kata) || []).length,
        Thai: (noSpaces.match(RX.thai) || []).length,
        Arabic: (noSpaces.match(RX.arab) || []).length,
        Devanagari: (noSpaces.match(RX.deva) || []).length,
        Cyrillic: (noSpaces.match(RX.cyrl) || []).length,
        Greek: (noSpaces.match(RX.greek) || []).length,
        Hebrew: (noSpaces.match(RX.hebr) || []).length
      };
      counts.Japanese = (counts.Hiragana || 0) + (counts.Katakana || 0);
      delete counts.Hiragana; delete counts.Katakana;

      let primary = { key: null, count: 0 };
      for (const [k, v] of Object.entries(counts)) if (v > primary.count) primary = { key: k, count: v };

      const englishDisplay = (primary.key === 'Korean') ? englishLetters : englishWords;

      const sumScripts = Object.values(counts).reduce((a,b)=>a+b,0);
      const englishForTotal = (primary.key === 'Korean') ? englishLetters : englishWords;
      const allLanguagesUnits = sumScripts + englishForTotal;
      const total = (primary.key === 'Korean') ? noSpaces.length : (allLanguagesUnits + digits);

      return { uiLang, counts, primary, englishDisplay, englishWords, digits, punct, total };
    }

    function render(stats) {
      const L = i18n.labels[stats.uiLang] || i18n.labels.en;
      const englishLabel = (stats.primary.key === 'Korean') ? L.enLetters : L.enWords;

      const scriptCards = Object.entries(stats.counts)
        .filter(([, v]) => v > 0)
        .map(([k, v]) => {
          const nameLoc = localScriptName(k, stats.uiLang);
          return `<div class="card"><div class="label">${L.scriptChars(nameLoc)}</div><div class="value">${v.toLocaleString()}</div></div>`;
        }).join('');

      let totalLabel = L.total;
      let totalSubtitle = '';
      if (stats.primary.key !== 'Korean') {
        const comp = [];
        for (const [k, v] of Object.entries(stats.counts)) if (v > 0) comp.push(localScriptName(k, stats.uiLang));
        if (stats.englishWords > 0) comp.push(englishLabel);
        comp.push(L.digits);
        totalSubtitle = `${comp.join(' + ')}, ${L.noPunct}`;
      }

      const resultElement = document.getElementById('result');
      if (stats.total === 0) {
        const L = i18n.ui[stats.uiLang] || i18n.ui.en;
        resultElement.innerHTML = `
          <div style="color: var(--muted); font-style: italic; text-align: center;">
            ${L.placeholderMessage || 'Enter text to see character count analysis results here.'}
          </div>
        `;
      } else {
        resultElement.innerHTML = `
          <div class="stats">
            ${scriptCards}
            <div class="card"><div class="label">${englishLabel}</div><div class="value">${stats.englishDisplay.toLocaleString()}</div></div>
            <div class="card"><div class="label">${L.digits}</div><div class="value">${stats.digits.toLocaleString()}</div></div>
            <div class="card"><div class="label">${L.punct}</div><div class="value">${stats.punct.toLocaleString()}</div></div>
            <div class="card">
              <div class="label">${totalLabel}</div>
              <div class="value">${stats.total.toLocaleString()}</div>
              ${totalSubtitle ? `<div class="subtitle" style="font-size:0.8em;color:var(--muted);margin-top:4px;">${totalSubtitle}</div>` : ''}
            </div>
          </div>
        `;
      }
    }

    async function pasteText() {
      trackUserAction('paste_button_clicked', { label: 'paste_button' });
      const el = document.getElementById('textInput');
      try {
        let clip = await navigator.clipboard.readText();
        clip = normalizePasted(clip);
        const start = el.selectionStart ?? el.value.length;
        const end   = el.selectionEnd ?? el.value.length;
        el.value = el.value.slice(0, start) + clip + el.value.slice(end);
        const pos = start + clip.length;
        el.setSelectionRange?.(pos, pos);
        trackUserAction('paste_successful', { label: 'clipboard_paste', value: clip.length });
      } catch {
        const fallback = prompt('Paste is not allowed by the browser.\nPlease paste your content here:');
        if (fallback !== null) {
          const cleaned = normalizePasted(fallback);
          el.value += (el.value ? '\n' : '') + cleaned;
          trackUserAction('paste_fallback_used', { label: 'manual_paste', value: cleaned.length });
        }
      }
      el.scrollTop = 0;
      showAdAfterPaste();
      el.focus();
    }

    function clearText() {
      trackUserAction('clear_button_clicked', { label: 'clear_button' });
      const el = document.getElementById('textInput');
      el.value = '';
      const uiLang = document.getElementById('lang').value;
      const L = i18n.ui[uiLang] || i18n.ui.en;
      document.getElementById('result').innerHTML = `
        <div style="color: var(--muted); font-style: italic; text-align: center;">
          ${L.placeholderMessage || 'Enter text to see character count analysis results here.'}
        </div>
      `;
      el.focus();
    }

    let inputTimer;
    function onInput() {
      clearTimeout(inputTimer);
      inputTimer = setTimeout(() => {
        const uiLang = document.getElementById('lang').value;
        const text = document.getElementById('textInput').value;
        const stats = analyze(text, uiLang);
        render(stats);
        
        // Track analytics if there's meaningful text
        if (text && text.trim().length > 0) {
          trackCharacterCount(text, stats, uiLang);
        }
      }, 100); // Slightly increased delay for better performance
    }
    
    // Add immediate feedback for typing
    function onInputImmediate() {
      const text = document.getElementById('textInput').value;
      const resultElement = document.getElementById('result');
      const uiLang = document.getElementById('lang').value;
      const L = i18n.ui[uiLang] || i18n.ui.en;
      
      if (text.trim().length === 0) {
        resultElement.innerHTML = `
          <div style="color: var(--muted); font-style: italic; text-align: center;">
            ${L.placeholderMessage || 'Enter text to see character count analysis results here.'}
          </div>
        `;
      } else {
        // Show loading state
        const loadingText = uiLang === 'ko' ? '분석 중...' : 
                           uiLang === 'zh-CN' ? '分析中...' :
                           uiLang === 'zh-TW' ? '分析中...' :
                           uiLang === 'ja' ? '分析中...' :
                           uiLang === 'th' ? 'กำลังวิเคราะห์...' :
                           uiLang === 'vi' ? 'Đang phân tích...' :
                           uiLang === 'ru' ? 'Анализ...' :
                           uiLang === 'ar' ? 'جاري التحليل...' :
                           uiLang === 'fr' ? 'Analyse en cours...' :
                           uiLang === 'de' ? 'Analysiere...' :
                           uiLang === 'es' ? 'Analizando...' :
                           uiLang === 'pt' ? 'Analisando...' :
                           'Analyzing...';
        resultElement.innerHTML = `
          <div style="color: var(--accent); text-align: center; font-weight: 500;">
            ${loadingText}
          </div>
        `;
      }
    }

    // Always show modal after paste (every time)
    // TEMPORARILY DISABLED FOR ADSENSE APPROVAL
    // TO RE-ENABLE AFTER ADSENSE APPROVAL:
    // 1. Uncomment the modal code below
    // 2. Comment out the onInput() call
    function showAdAfterPaste() {
      // RE-ENABLE AFTER ADSENSE APPROVAL:
      // const modal = document.getElementById('adModal');
      // modal.style.display = 'flex';
      // document.getElementById('adClose').onclick = () => {
      //   modal.style.display = 'none';
      //   onInput();
      // };
      
      // TEMPORARY: Just trigger input analysis without popup
      onInput();
    }

    // Browser language detection
    function detectBrowserLanguage() {
      const browserLang = navigator.language || navigator.userLanguage || 'en';
      const langCode = browserLang.split('-')[0]; // Get primary language code
      
      // Map browser languages to our supported languages
      const langMap = {
        'ko': 'ko',
        'zh': 'zh-CN',
        'ja': 'ja',
        'th': 'th',
        'vi': 'vi',
        'ru': 'ru',
        'ar': 'ar',
        'fr': 'fr',
        'de': 'de',
        'es': 'es',
        'pt': 'pt'
      };
      
      return langMap[langCode] || 'en'; // Default to English if not supported
    }

    window.addEventListener('DOMContentLoaded', () => {
      // Fill localized thank-you message in modal (optional simple EN/KR)
      const msg = {
        en: "Thanks for using our text counter. Close this message to see your results.",
        ko: "이용해 주셔서 감사합니다. 닫기를 누르면 결과를 확인할 수 있어요."
      };
      
      const sel = document.getElementById('lang');
      sel.innerHTML = ['en','ko','zh-CN','zh-TW','ja','th','vi','ru','ar','fr','de','es','pt'].map(code => {
        const label = ({en:'English',ko:'한국어','zh-CN':'中文(简体)','zh-TW':'中文(繁體)',ja:'日本語',th:'ภาษาไทย',vi:'Tiếng Việt',ru:'Русский',ar:'العربية',fr:'Français',de:'Deutsch',es:'Español',pt:'Português'})[code];
        return `<option value="${code}">${label}</option>`;
      }).join('');
      
      // Set default language based on browser
      const defaultLang = detectBrowserLanguage();
      sel.value = defaultLang;
      
      // Initialize UI with detected language
      setUILanguage(defaultLang);
      document.getElementById('adMessage').textContent =
        defaultLang === 'ko' ? msg.ko : msg.en;
      
      // Initialize result area with placeholder message
      const resultElement = document.getElementById('result');
      if (resultElement && !resultElement.innerHTML.trim()) {
        const L = i18n.ui[defaultLang] || i18n.ui.en;
        resultElement.innerHTML = `
          <div style="color: var(--muted); font-style: italic; text-align: center;">
            ${L.placeholderMessage || 'Enter text to see character count analysis results here.'}
          </div>
        `;
      }
      
      sel.addEventListener('change', () => {
        const selectedLang = sel.value;
        const langNames = {
          'en': 'English', 'ko': '한국어', 'zh-CN': '中文(简体)',
          'zh-TW': '中文(繁體)', 'ja': '日本語', 'th': 'ภาษาไทย',
          'vi': 'Tiếng Việt', 'ru': 'Русский', 'ar': 'العربية',
          'fr': 'Français', 'de': 'Deutsch', 'es': 'Español', 'pt': 'Português'
        };
        
        // Track UI language change with detailed info
        gtag('event', 'ui_language_changed', {
          'event_category': 'user_preference',
          'event_label': selectedLang,
          'value': 1,
          'language_code': selectedLang,
          'language_name': langNames[selectedLang] || selectedLang
        });
        
        setUILanguage(selectedLang);
        document.getElementById('adMessage').textContent =
          selectedLang === 'ko' ? msg.ko : msg.en;
      });

      // Top paste button
      document.getElementById('pasteBtnTop').addEventListener('click', pasteText);
      // Clear
      document.getElementById('clearBtn').addEventListener('click', clearText);
      // Rules button
      document.getElementById('rulesBtn').addEventListener('click', () => {
        document.getElementById('rulesModal').style.display = 'flex';
      });

      // Textarea typing
      const ta = document.getElementById('textInput');
      ta.addEventListener('input', () => {
        onInputImmediate(); // Show immediate feedback
        onInput(); // Then do the actual analysis
      });
      // Keyboard paste handling (Cmd/Ctrl+V)
      ta.addEventListener('paste', (e) => {
        e.preventDefault();
        const raw = (e.clipboardData || window.clipboardData)?.getData('text') || '';
        const cleaned = normalizePasted(raw);
        const start = ta.selectionStart ?? ta.value.length;
        const end   = ta.selectionEnd ?? ta.value.length;
        ta.value = ta.value.slice(0, start) + cleaned + ta.value.slice(end);
        const pos = start + cleaned.length;
        ta.setSelectionRange?.(pos, pos);
        ta.scrollTop = 0;
        showAdAfterPaste(); // Will just trigger analysis, no popup
        ta.focus();
      }, { capture: true });

      // Language is already set by detectBrowserLanguage() above
      
      // Logo click handler (scroll to top)
      document.getElementById('logoHome').addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
      
      // Footer click handled by onclick attribute

      // Contact modal functionality
      const contactModal = document.getElementById('contactModal');
      const contactBtn = document.getElementById('contactBtn');
      const contactClose = document.getElementById('contactClose');
      const contactCancel = document.getElementById('contactCancel');
      const contactForm = document.getElementById('contactForm');

      // Open contact modal
      contactBtn.addEventListener('click', () => {
        contactModal.style.display = 'flex';
      });

      // Close contact modal
      function closeContactModal() {
        contactModal.style.display = 'none';
        contactForm.reset();
      }

      contactClose.addEventListener('click', closeContactModal);
      contactCancel.addEventListener('click', closeContactModal);

      // Close modal when clicking outside
      contactModal.addEventListener('click', (e) => {
        if (e.target === contactModal) {
          closeContactModal();
        }
      });

      // Rules modal functionality
      const rulesModal = document.getElementById('rulesModal');
      const rulesClose = document.getElementById('rulesClose');

      // Close rules modal
      function closeRulesModal() {
        rulesModal.style.display = 'none';
        // Ensure the rules button is still visible after closing modal
        const rulesBtn = document.getElementById('rulesBtn');
        if (rulesBtn) {
          rulesBtn.style.display = 'block';
          rulesBtn.style.visibility = 'visible';
        }
      }

      rulesClose.addEventListener('click', closeRulesModal);

      // Close modal when clicking outside
      rulesModal.addEventListener('click', (e) => {
        if (e.target === rulesModal) {
          closeRulesModal();
        }
      });

      // Handle form submission
      contactForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('contactEmail').value;
        const phone = document.getElementById('contactPhone').value;
        const message = document.getElementById('contactMessage').value;
        
        // Create mailto link
        const subject = encodeURIComponent('TypeStats Contact Form');
        const body = encodeURIComponent(
          `Email: ${email}\n` +
          `Phone: ${phone || 'Not provided'}\n\n` +
          `Message:\n${message}`
        );
        
        const mailtoLink = `mailto:xyyelaine@gmail.com?subject=${subject}&body=${body}`;
        
        // Open email client
        window.location.href = mailtoLink;
        
        // Show success message
        const currentLang = document.getElementById('lang').value;
        const successMsg = i18n.ui[currentLang]?.contactSuccess || i18n.ui.en.contactSuccess;
        alert(successMsg);
        
        // Close modal
        closeContactModal();
      });
      
      // Mobile touch optimizations
      
      // Prevent zoom on double tap for mobile
      let lastTouchEnd = 0;
      ta.addEventListener('touchend', (e) => {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          e.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      // Improve touch scrolling
      ta.style.webkitOverflowScrolling = 'touch';
      
      // Add touch feedback for buttons
      const buttons = document.querySelectorAll('button');
      buttons.forEach(btn => {
        btn.addEventListener('touchstart', () => {
          btn.style.transform = 'scale(0.98)';
        });
        btn.addEventListener('touchend', () => {
          btn.style.transform = 'scale(1)';
        });
      });
      
    });

    // Light "view source" deterrents (bypassable)
    document.addEventListener('contextmenu', (e) => e.preventDefault());
    document.addEventListener('keydown', (e) => {
      const k = e.key.toLowerCase();
      const ctrl = e.ctrlKey || e.metaKey;
      if (
        k === 'f12' ||
        (ctrl && k === 'u') ||
        (ctrl && e.shiftKey && ['i','j','c'].includes(k))
      ) {
        e.preventDefault();
      }
    });


    
    // Optional: limit features to your domain (keep modal)
    (function lockToDomain() {
      const allowed = ['typestats', 'localhost', '127.0.0.1', 'vercel.app'];
      const host = location.hostname || '';
      if (!allowed.some(a => host.includes(a))) {
        // Keep the app, but you could disable specific features if needed
      }
    })();
  </script>
<script defer src="/vercel/insights/script.js"></script>  
</body>
</html>